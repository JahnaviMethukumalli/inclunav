{"ast":null,"code":"var leafletControlGeocoder = function (L) {\n  function _inheritsLoose(subClass, superClass) {\n    subClass.prototype = Object.create(superClass.prototype);\n    subClass.prototype.constructor = subClass;\n    subClass.__proto__ = superClass;\n  }\n\n  function _assertThisInitialized(self) {\n    if (self === void 0) {\n      throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n    }\n\n    return self;\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function geocodingParams(options, params) {\n    return L.Util.extend(params, options.geocodingQueryParams);\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function reverseParams(options, params) {\n    return L.Util.extend(params, options.reverseQueryParams);\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  var lastCallbackId = 0; // Adapted from handlebars.js\n  // https://github.com/wycats/handlebars.js/\n\n  /**\r\n   * @internal\r\n   */\n\n  var badChars = /[&<>\"'`]/g;\n  /**\r\n   * @internal\r\n   */\n\n  var possible = /[&<>\"'`]/;\n  /**\r\n   * @internal\r\n   */\n\n  var escape = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#x27;',\n    '`': '&#x60;'\n  };\n  /**\r\n   * @internal\r\n   */\n\n  function escapeChar(chr) {\n    return escape[chr];\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function htmlEscape(string) {\n    if (string == null) {\n      return '';\n    } else if (!string) {\n      return string + '';\n    } // Force a string conversion as this will be done by the append regardless and\n    // the regex test will do this transparently behind the scenes, causing issues if\n    // an object's to string has escaped characters in it.\n\n\n    string = '' + string;\n\n    if (!possible.test(string)) {\n      return string;\n    }\n\n    return string.replace(badChars, escapeChar);\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function jsonp(url, params, callback, context, jsonpParam) {\n    var callbackId = '_l_geocoder_' + lastCallbackId++;\n    params[jsonpParam || 'callback'] = callbackId;\n    window[callbackId] = L.Util.bind(callback, context);\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = url + getParamString(params);\n    script.id = callbackId;\n    document.getElementsByTagName('head')[0].appendChild(script);\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function getJSON(url, params, callback) {\n    var xmlHttp = new XMLHttpRequest();\n\n    xmlHttp.onreadystatechange = function () {\n      if (xmlHttp.readyState !== 4) {\n        return;\n      }\n\n      var message;\n\n      if (xmlHttp.status !== 200 && xmlHttp.status !== 304) {\n        message = '';\n      } else if (typeof xmlHttp.response === 'string') {\n        // IE doesn't parse JSON responses even with responseType: 'json'.\n        try {\n          message = JSON.parse(xmlHttp.response);\n        } catch (e) {\n          // Not a JSON response\n          message = xmlHttp.response;\n        }\n      } else {\n        message = xmlHttp.response;\n      }\n\n      callback(message);\n    };\n\n    xmlHttp.open('GET', url + getParamString(params), true);\n    xmlHttp.responseType = 'json';\n    xmlHttp.setRequestHeader('Accept', 'application/json');\n    xmlHttp.send(null);\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function template(str, data) {\n    return str.replace(/\\{ *([\\w_]+) *\\}/g, function (str, key) {\n      var value = data[key];\n\n      if (value === undefined) {\n        value = '';\n      } else if (typeof value === 'function') {\n        value = value(data);\n      }\n\n      return htmlEscape(value);\n    });\n  }\n  /**\r\n   * @internal\r\n   */\n\n\n  function getParamString(obj, existingUrl, uppercase) {\n    var params = [];\n\n    for (var i in obj) {\n      var key = encodeURIComponent(uppercase ? i.toUpperCase() : i);\n      var value = obj[i];\n\n      if (!Array.isArray(value)) {\n        params.push(key + '=' + encodeURIComponent(String(value)));\n      } else {\n        for (var j = 0; j < value.length; j++) {\n          params.push(key + '=' + encodeURIComponent(value[j]));\n        }\n      }\n    }\n\n    return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n  }\n  /**\r\n   * Implementation of the [ArcGIS geocoder](https://developers.arcgis.com/features/geocoding/)\r\n   */\n\n\n  var ArcGis = /*#__PURE__*/function () {\n    function ArcGis(options) {\n      this.options = {\n        serviceUrl: 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer',\n        apiKey: ''\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = ArcGis.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        token: this.options.apiKey,\n        SingleLine: query,\n        outFields: 'Addr_Type',\n        forStorage: false,\n        maxLocations: 10,\n        f: 'json'\n      });\n      getJSON(this.options.serviceUrl + '/findAddressCandidates', params, function (data) {\n        var results = [];\n\n        if (data.candidates && data.candidates.length) {\n          for (var i = 0; i <= data.candidates.length - 1; i++) {\n            var loc = data.candidates[i];\n            var latLng = L.latLng(loc.location.y, loc.location.x);\n            var latLngBounds = L.latLngBounds(L.latLng(loc.extent.ymax, loc.extent.xmax), L.latLng(loc.extent.ymin, loc.extent.xmin));\n            results[i] = {\n              name: loc.address,\n              bbox: latLngBounds,\n              center: latLng\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        location: encodeURIComponent(location.lng) + ',' + encodeURIComponent(location.lat),\n        distance: 100,\n        f: 'json'\n      });\n      getJSON(this.options.serviceUrl + '/reverseGeocode', params, function (data) {\n        var result = [];\n\n        if (data && !data.error) {\n          var center = L.latLng(data.location.y, data.location.x);\n          var bbox = L.latLngBounds(center, center);\n          result.push({\n            name: data.address.Match_addr,\n            center: center,\n            bbox: bbox\n          });\n        }\n\n        cb.call(context, result);\n      });\n    };\n\n    return ArcGis;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link ArcGis}\r\n   * @param options the options\r\n   */\n\n\n  function arcgis(options) {\n    return new ArcGis(options);\n  }\n  /**\r\n   * Implementation of the [Bing Locations API](https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/)\r\n   */\n\n\n  var Bing = /*#__PURE__*/function () {\n    function Bing(options) {\n      this.options = {\n        serviceUrl: 'https://dev.virtualearth.net/REST/v1/Locations'\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = Bing.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        query: query,\n        key: this.options.apiKey\n      });\n      jsonp(this.options.apiKey, params, function (data) {\n        var results = [];\n\n        if (data.resourceSets.length > 0) {\n          for (var i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n            var resource = data.resourceSets[0].resources[i],\n                bbox = resource.bbox;\n            results[i] = {\n              name: resource.name,\n              bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n              center: L.latLng(resource.point.coordinates)\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this, 'jsonp');\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        key: this.options.apiKey\n      });\n      jsonp(this.options.serviceUrl + location.lat + ',' + location.lng, params, function (data) {\n        var results = [];\n\n        for (var i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n          var resource = data.resourceSets[0].resources[i],\n              bbox = resource.bbox;\n          results[i] = {\n            name: resource.name,\n            bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n            center: L.latLng(resource.point.coordinates)\n          };\n        }\n\n        cb.call(context, results);\n      }, this, 'jsonp');\n    };\n\n    return Bing;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Bing}\r\n   * @param options the options\r\n   */\n\n\n  function bing(options) {\n    return new Bing(options);\n  }\n\n  var Google = /*#__PURE__*/function () {\n    function Google(options) {\n      this.options = {\n        serviceUrl: 'https://maps.googleapis.com/maps/api/geocode/json'\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = Google.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        key: this.options.apiKey,\n        address: query\n      });\n      getJSON(this.options.serviceUrl, params, function (data) {\n        var results = [];\n\n        if (data.results && data.results.length) {\n          for (var i = 0; i <= data.results.length - 1; i++) {\n            var loc = data.results[i];\n            var latLng = L.latLng(loc.geometry.location);\n            var latLngBounds = L.latLngBounds(L.latLng(loc.geometry.viewport.northeast), L.latLng(loc.geometry.viewport.southwest));\n            results[i] = {\n              name: loc.formatted_address,\n              bbox: latLngBounds,\n              center: latLng,\n              properties: loc.address_components\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        key: this.options.apiKey,\n        latlng: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng)\n      });\n      getJSON(this.options.serviceUrl, params, function (data) {\n        var results = [];\n\n        if (data.results && data.results.length) {\n          for (var i = 0; i <= data.results.length - 1; i++) {\n            var loc = data.results[i];\n            var center = L.latLng(loc.geometry.location);\n            var bbox = L.latLngBounds(L.latLng(loc.geometry.viewport.northeast), L.latLng(loc.geometry.viewport.southwest));\n            results[i] = {\n              name: loc.formatted_address,\n              bbox: bbox,\n              center: center,\n              properties: loc.address_components\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return Google;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Google}\r\n   * @param options the options\r\n   */\n\n\n  function google(options) {\n    return new Google(options);\n  }\n  /**\r\n   * Implementation of the [HERE Geocoder API](https://developer.here.com/documentation/geocoder/topics/introduction.html)\r\n   */\n\n\n  var HERE = /*#__PURE__*/function () {\n    function HERE(options) {\n      this.options = {\n        serviceUrl: 'https://geocoder.api.here.com/6.2/',\n        app_id: '',\n        app_code: '',\n        apiKey: ''\n      };\n      L.Util.setOptions(this, options);\n      if (options.apiKey) throw Error('apiKey is not supported, use app_id/app_code instead!');\n    }\n\n    var _proto = HERE.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        searchtext: query,\n        gen: 9,\n        app_id: this.options.app_id,\n        app_code: this.options.app_code,\n        jsonattributes: 1\n      });\n      this.getJSON(this.options.serviceUrl + 'geocode.json', params, cb, context);\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var _proxRadius = this.options.reverseGeocodeProxRadius ? this.options.reverseGeocodeProxRadius : null;\n\n      var proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n      var params = reverseParams(this.options, {\n        prox: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng) + proxRadius,\n        mode: 'retrieveAddresses',\n        app_id: this.options.app_id,\n        app_code: this.options.app_code,\n        gen: 9,\n        jsonattributes: 1\n      });\n      this.getJSON(this.options.serviceUrl + 'reversegeocode.json', params, cb, context);\n    };\n\n    _proto.getJSON = function getJSON$1(url, params, cb, context) {\n      getJSON(url, params, function (data) {\n        var results = [];\n\n        if (data.response.view && data.response.view.length) {\n          for (var i = 0; i <= data.response.view[0].result.length - 1; i++) {\n            var loc = data.response.view[0].result[i].location;\n            var center = L.latLng(loc.displayPosition.latitude, loc.displayPosition.longitude);\n            var bbox = L.latLngBounds(L.latLng(loc.mapView.topLeft.latitude, loc.mapView.topLeft.longitude), L.latLng(loc.mapView.bottomRight.latitude, loc.mapView.bottomRight.longitude));\n            results[i] = {\n              name: loc.address.label,\n              properties: loc.address,\n              bbox: bbox,\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return HERE;\n  }();\n  /**\r\n   * Implementation of the new [HERE Geocoder API](https://developer.here.com/documentation/geocoding-search-api/api-reference-swagger.html)\r\n   */\n\n\n  var HEREv2 = /*#__PURE__*/function () {\n    function HEREv2(options) {\n      this.options = {\n        serviceUrl: 'https://geocode.search.hereapi.com/v1',\n        apiKey: '',\n        app_id: '',\n        app_code: ''\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto2 = HEREv2.prototype;\n\n    _proto2.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        q: query,\n        apiKey: this.options.apiKey\n      });\n\n      if (!params.at && !params[\"in\"]) {\n        throw Error('at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.');\n      }\n\n      this.getJSON(this.options.serviceUrl + '/discover', params, cb, context);\n    };\n\n    _proto2.reverse = function reverse(location, scale, cb, context) {\n      var _proxRadius = this.options.reverseGeocodeProxRadius ? this.options.reverseGeocodeProxRadius : null;\n\n      var proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n      var params = reverseParams(this.options, {\n        at: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng),\n        apiKey: this.options.apiKey\n      });\n\n      if (proxRadius) {\n        params.limit = proxRadius;\n      }\n\n      this.getJSON(this.options.serviceUrl + '/revgeocode', params, cb, context);\n    };\n\n    _proto2.getJSON = function getJSON$1(url, params, cb, context) {\n      getJSON(url, params, function (data) {\n        var results = [];\n\n        if (data.items && data.items.length) {\n          for (var i = 0; i <= data.items.length - 1; i++) {\n            var item = data.items[i];\n            var latLng = L.latLng(item.position.lat, item.position.lng);\n            var bbox = void 0;\n\n            if (item.mapView) {\n              bbox = L.latLngBounds(L.latLng(item.mapView.south, item.mapView.west), L.latLng(item.mapView.north, item.mapView.east));\n            } else {\n              // Using only position when not provided\n              bbox = L.latLngBounds(L.latLng(item.position.lat, item.position.lng), L.latLng(item.position.lat, item.position.lng));\n            }\n\n            results[i] = {\n              name: item.address.label,\n              properties: item.address,\n              bbox: bbox,\n              center: latLng\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return HEREv2;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link HERE}\r\n   * @param options the options\r\n   */\n\n\n  function here(options) {\n    if (options.apiKey) {\n      return new HEREv2(options);\n    } else {\n      return new HERE(options);\n    }\n  }\n  /**\r\n   * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n   * @param query the latitude/longitude string to parse\r\n   * @returns the parsed latitude/longitude\r\n   */\n\n\n  function parseLatLng(query) {\n    var match; // regex from https://github.com/openstreetmap/openstreetmap-website/blob/master/app/controllers/geocoder_controller.rb\n\n    if (match = query.match(/^([NS])\\s*(\\d{1,3}(?:\\.\\d*)?)\\W*([EW])\\s*(\\d{1,3}(?:\\.\\d*)?)$/)) {\n      // [NSEW] decimal degrees\n      return L.latLng((/N/i.test(match[1]) ? 1 : -1) * parseFloat(match[2]), (/E/i.test(match[3]) ? 1 : -1) * parseFloat(match[4]));\n    } else if (match = query.match(/^(\\d{1,3}(?:\\.\\d*)?)\\s*([NS])\\W*(\\d{1,3}(?:\\.\\d*)?)\\s*([EW])$/)) {\n      // decimal degrees [NSEW]\n      return L.latLng((/N/i.test(match[2]) ? 1 : -1) * parseFloat(match[1]), (/E/i.test(match[4]) ? 1 : -1) * parseFloat(match[3]));\n    } else if (match = query.match(/^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?$/)) {\n      // [NSEW] degrees, decimal minutes\n      return L.latLng((/N/i.test(match[1]) ? 1 : -1) * (parseFloat(match[2]) + parseFloat(match[3]) / 60), (/E/i.test(match[4]) ? 1 : -1) * (parseFloat(match[5]) + parseFloat(match[6]) / 60));\n    } else if (match = query.match(/^(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([EW])$/)) {\n      // degrees, decimal minutes [NSEW]\n      return L.latLng((/N/i.test(match[3]) ? 1 : -1) * (parseFloat(match[1]) + parseFloat(match[2]) / 60), (/E/i.test(match[6]) ? 1 : -1) * (parseFloat(match[4]) + parseFloat(match[5]) / 60));\n    } else if (match = query.match(/^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?$/)) {\n      // [NSEW] degrees, minutes, decimal seconds\n      return L.latLng((/N/i.test(match[1]) ? 1 : -1) * (parseFloat(match[2]) + parseFloat(match[3]) / 60 + parseFloat(match[4]) / 3600), (/E/i.test(match[5]) ? 1 : -1) * (parseFloat(match[6]) + parseFloat(match[7]) / 60 + parseFloat(match[8]) / 3600));\n    } else if (match = query.match(/^(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\s*([EW])$/)) {\n      // degrees, minutes, decimal seconds [NSEW]\n      return L.latLng((/N/i.test(match[4]) ? 1 : -1) * (parseFloat(match[1]) + parseFloat(match[2]) / 60 + parseFloat(match[3]) / 3600), (/E/i.test(match[8]) ? 1 : -1) * (parseFloat(match[5]) + parseFloat(match[6]) / 60 + parseFloat(match[7]) / 3600));\n    } else if (match = query.match(/^\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*[\\s,]\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*$/)) {\n      return L.latLng(parseFloat(match[1]), parseFloat(match[2]));\n    }\n  }\n  /**\r\n   * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\r\n   */\n\n\n  var LatLng = /*#__PURE__*/function () {\n    function LatLng(options) {\n      this.options = {\n        next: undefined,\n        sizeInMeters: 10000\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = LatLng.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var center = parseLatLng(query);\n\n      if (center) {\n        var results = [{\n          name: query,\n          center: center,\n          bbox: center.toBounds(this.options.sizeInMeters)\n        }];\n        cb.call(context, results);\n      } else if (this.options.next) {\n        this.options.next.geocode(query, cb, context);\n      }\n    };\n\n    return LatLng;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link LatLng}\r\n   * @param options the options\r\n   */\n\n\n  function latLng(options) {\n    return new LatLng(options);\n  }\n  /**\r\n   * Implementation of the [Mapbox Geocoding](https://www.mapbox.com/api-documentation/#geocoding)\r\n   */\n\n\n  var Mapbox = /*#__PURE__*/function () {\n    function Mapbox(options) {\n      this.options = {\n        serviceUrl: 'https://api.mapbox.com/geocoding/v5/mapbox.places/'\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = Mapbox.prototype;\n\n    _proto._getProperties = function _getProperties(loc) {\n      var properties = {\n        text: loc.text,\n        address: loc.address\n      };\n\n      for (var j = 0; j < (loc.context || []).length; j++) {\n        var id = loc.context[j].id.split('.')[0];\n        properties[id] = loc.context[j].text; // Get country code when available\n\n        if (loc.context[j].short_code) {\n          properties['countryShortCode'] = loc.context[j].short_code;\n        }\n      }\n\n      return properties;\n    };\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var _this = this;\n\n      var params = geocodingParams(this.options, {\n        access_token: this.options.apiKey\n      });\n\n      if (params.proximity !== undefined && params.proximity.lat !== undefined && params.proximity.lng !== undefined) {\n        params.proximity = params.proximity.lng + ',' + params.proximity.lat;\n      }\n\n      getJSON(this.options.serviceUrl + encodeURIComponent(query) + '.json', params, function (data) {\n        var results = [];\n\n        if (data.features && data.features.length) {\n          for (var i = 0; i <= data.features.length - 1; i++) {\n            var loc = data.features[i];\n            var center = L.latLng(loc.center.reverse());\n            var bbox = void 0;\n\n            if (loc.bbox) {\n              bbox = L.latLngBounds(L.latLng(loc.bbox.slice(0, 2).reverse()), L.latLng(loc.bbox.slice(2, 4).reverse()));\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n\n            results[i] = {\n              name: loc.place_name,\n              bbox: bbox,\n              center: center,\n              properties: _this._getProperties(loc)\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var _this2 = this;\n\n      var param = reverseParams(this.options, {\n        access_token: this.options.apiKey\n      });\n      getJSON(this.options.serviceUrl + encodeURIComponent(location.lng) + ',' + encodeURIComponent(location.lat) + '.json', param, function (data) {\n        var results = [];\n\n        if (data.features && data.features.length) {\n          for (var i = 0; i <= data.features.length - 1; i++) {\n            var loc = data.features[i];\n            var center = L.latLng(loc.center.reverse());\n            var bbox = void 0;\n\n            if (loc.bbox) {\n              bbox = L.latLngBounds(L.latLng(loc.bbox.slice(0, 2).reverse()), L.latLng(loc.bbox.slice(2, 4).reverse()));\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n\n            results[i] = {\n              name: loc.place_name,\n              bbox: bbox,\n              center: center,\n              properties: _this2._getProperties(loc)\n            };\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return Mapbox;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Mapbox}\r\n   * @param options the options\r\n   */\n\n\n  function mapbox(options) {\n    return new Mapbox(options);\n  }\n  /**\r\n   * Implementation of the [MapQuest Geocoding API](http://developer.mapquest.com/web/products/dev-services/geocoding-ws)\r\n   */\n\n\n  var MapQuest = /*#__PURE__*/function () {\n    function MapQuest(options) {\n      this.options = {\n        serviceUrl: 'https://www.mapquestapi.com/geocoding/v1'\n      };\n      L.Util.setOptions(this, options); // MapQuest seems to provide URI encoded API keys,\n      // so to avoid encoding them twice, we decode them here\n\n      this.options.apiKey = decodeURIComponent(this.options.apiKey);\n    }\n\n    var _proto = MapQuest.prototype;\n\n    _proto._formatName = function _formatName() {\n      return [].slice.call(arguments).filter(function (s) {\n        return !!s;\n      }).join(', ');\n    };\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        key: this.options.apiKey,\n        location: query,\n        limit: 5,\n        outFormat: 'json'\n      });\n      getJSON(this.options.serviceUrl + '/address', params, L.Util.bind(function (data) {\n        var results = [];\n\n        if (data.results && data.results[0].locations) {\n          for (var i = data.results[0].locations.length - 1; i >= 0; i--) {\n            var loc = data.results[0].locations[i];\n            var center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this));\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        key: this.options.apiKey,\n        location: location.lat + ',' + location.lng,\n        outputFormat: 'json'\n      });\n      getJSON(this.options.serviceUrl + '/reverse', params, L.Util.bind(function (data) {\n        var results = [];\n\n        if (data.results && data.results[0].locations) {\n          for (var i = data.results[0].locations.length - 1; i >= 0; i--) {\n            var loc = data.results[0].locations[i];\n            var center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this));\n    };\n\n    return MapQuest;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link MapQuest}\r\n   * @param options the options\r\n   */\n\n\n  function mapQuest(options) {\n    return new MapQuest(options);\n  }\n  /**\r\n   * Implementation of the [Neutrino API](https://www.neutrinoapi.com/api/geocode-address/)\r\n   */\n\n\n  var Neutrino = /*#__PURE__*/function () {\n    function Neutrino(options) {\n      this.options = {\n        userId: undefined,\n        apiKey: undefined,\n        serviceUrl: 'https://neutrinoapi.com/'\n      };\n      L.Util.setOptions(this, options);\n    } // https://www.neutrinoapi.com/api/geocode-address/\n\n\n    var _proto = Neutrino.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        apiKey: this.options.apiKey,\n        userId: this.options.userId,\n        //get three words and make a dot based string\n        address: query.split(/\\s+/).join('.')\n      });\n      getJSON(this.options.serviceUrl + 'geocode-address', params, function (data) {\n        var results = [];\n\n        if (data.locations) {\n          data.geometry = data.locations[0];\n          var center = L.latLng(data.geometry['latitude'], data.geometry['longitude']);\n          var bbox = L.latLngBounds(center, center);\n          results[0] = {\n            name: data.geometry.address,\n            bbox: bbox,\n            center: center\n          };\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    } // https://www.neutrinoapi.com/api/geocode-reverse/\n    ;\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        apiKey: this.options.apiKey,\n        userId: this.options.userId,\n        latitude: location.lat,\n        longitude: location.lng\n      });\n      getJSON(this.options.serviceUrl + 'geocode-reverse', params, function (data) {\n        var results = [];\n\n        if (data.status.status == 200 && data.found) {\n          var center = L.latLng(location.lat, location.lng);\n          var bbox = L.latLngBounds(center, center);\n          results[0] = {\n            name: data.address,\n            bbox: bbox,\n            center: center\n          };\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return Neutrino;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Neutrino}\r\n   * @param options the options\r\n   */\n\n\n  function neutrino(options) {\n    return new Neutrino(options);\n  }\n  /**\r\n   * Implementation of the [Nominatim](https://wiki.openstreetmap.org/wiki/Nominatim) geocoder.\r\n   *\r\n   * This is the default geocoding service used by the control, unless otherwise specified in the options.\r\n   *\r\n   * Unless using your own Nominatim installation, please refer to the [Nominatim usage policy](https://operations.osmfoundation.org/policies/nominatim/).\r\n   */\n\n\n  var Nominatim = /*#__PURE__*/function () {\n    function Nominatim(options) {\n      this.options = {\n        serviceUrl: 'https://nominatim.openstreetmap.org/',\n        htmlTemplate: function htmlTemplate(r) {\n          var address = r.address;\n          var className;\n          var parts = [];\n\n          if (address.road || address.building) {\n            parts.push('{building} {road} {house_number}');\n          }\n\n          if (address.city || address.town || address.village || address.hamlet) {\n            className = parts.length > 0 ? 'leaflet-control-geocoder-address-detail' : '';\n            parts.push('<span class=\"' + className + '\">{postcode} {city} {town} {village} {hamlet}</span>');\n          }\n\n          if (address.state || address.country) {\n            className = parts.length > 0 ? 'leaflet-control-geocoder-address-context' : '';\n            parts.push('<span class=\"' + className + '\">{state} {country}</span>');\n          }\n\n          return template(parts.join('<br/>'), address);\n        }\n      };\n      L.Util.setOptions(this, options || {});\n    }\n\n    var _proto = Nominatim.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var _this = this;\n\n      var params = geocodingParams(this.options, {\n        q: query,\n        limit: 5,\n        format: 'json',\n        addressdetails: 1\n      });\n      getJSON(this.options.serviceUrl + 'search', params, function (data) {\n        var results = [];\n\n        for (var i = data.length - 1; i >= 0; i--) {\n          var bbox = data[i].boundingbox;\n\n          for (var j = 0; j < 4; j++) {\n            bbox[j] = parseFloat(bbox[j]);\n          }\n\n          results[i] = {\n            icon: data[i].icon,\n            name: data[i].display_name,\n            html: _this.options.htmlTemplate ? _this.options.htmlTemplate(data[i]) : undefined,\n            bbox: L.latLngBounds([bbox[0], bbox[2]], [bbox[1], bbox[3]]),\n            center: L.latLng(data[i].lat, data[i].lon),\n            properties: data[i]\n          };\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var _this2 = this;\n\n      var params = reverseParams(this.options, {\n        lat: location.lat,\n        lon: location.lng,\n        zoom: Math.round(Math.log(scale / 256) / Math.log(2)),\n        addressdetails: 1,\n        format: 'json'\n      });\n      getJSON(this.options.serviceUrl + 'reverse', params, function (data) {\n        var result = [];\n\n        if (data && data.lat && data.lon) {\n          var center = L.latLng(data.lat, data.lon);\n          var bbox = L.latLngBounds(center, center);\n          result.push({\n            name: data.display_name,\n            html: _this2.options.htmlTemplate ? _this2.options.htmlTemplate(data) : undefined,\n            center: center,\n            bbox: bbox,\n            properties: data\n          });\n        }\n\n        cb.call(context, result);\n      });\n    };\n\n    return Nominatim;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Nominatim}\r\n   * @param options the options\r\n   */\n\n\n  function nominatim(options) {\n    return new Nominatim(options);\n  }\n  /**\r\n   * Implementation of the [Plus codes](https://plus.codes/) (formerly OpenLocationCode) (requires [open-location-code](https://www.npmjs.com/package/open-location-code))\r\n   */\n\n\n  var OpenLocationCode = /*#__PURE__*/function () {\n    function OpenLocationCode(options) {\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = OpenLocationCode.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      try {\n        var decoded = this.options.OpenLocationCode.decode(query);\n        var result = {\n          name: query,\n          center: L.latLng(decoded.latitudeCenter, decoded.longitudeCenter),\n          bbox: L.latLngBounds(L.latLng(decoded.latitudeLo, decoded.longitudeLo), L.latLng(decoded.latitudeHi, decoded.longitudeHi))\n        };\n        cb.call(context, [result]);\n      } catch (e) {\n        console.warn(e); // eslint-disable-line no-console\n\n        cb.call(context, []);\n      }\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      try {\n        var code = this.options.OpenLocationCode.encode(location.lat, location.lng, this.options.codeLength);\n        var result = {\n          name: code,\n          center: L.latLng(location.lat, location.lng),\n          bbox: L.latLngBounds(L.latLng(location.lat, location.lng), L.latLng(location.lat, location.lng))\n        };\n        cb.call(context, [result]);\n      } catch (e) {\n        console.warn(e); // eslint-disable-line no-console\n\n        cb.call(context, []);\n      }\n    };\n\n    return OpenLocationCode;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link OpenLocationCode}\r\n   * @param options the options\r\n   */\n\n\n  function openLocationCode(options) {\n    return new OpenLocationCode(options);\n  }\n  /**\r\n   * Implementation of the [OpenCage Data API](https://opencagedata.com/)\r\n   */\n\n\n  var OpenCage = /*#__PURE__*/function () {\n    function OpenCage(options) {\n      this.options = {\n        serviceUrl: 'https://api.opencagedata.com/geocode/v1/json'\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = OpenCage.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        key: this.options.apiKey,\n        q: query\n      });\n      getJSON(this.options.serviceUrl, params, function (data) {\n        var results = [];\n\n        if (data.results && data.results.length) {\n          for (var i = 0; i < data.results.length; i++) {\n            var loc = data.results[i];\n            var center = L.latLng(loc.geometry);\n            var bbox = void 0;\n\n            if (loc.annotations && loc.annotations.bounds) {\n              bbox = L.latLngBounds(L.latLng(loc.annotations.bounds.northeast), L.latLng(loc.annotations.bounds.southwest));\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n\n            results.push({\n              name: loc.formatted,\n              bbox: bbox,\n              center: center\n            });\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        key: this.options.apiKey,\n        q: [location.lat, location.lng].join(',')\n      });\n      getJSON(this.options.serviceUrl, params, function (data) {\n        var results = [];\n\n        if (data.results && data.results.length) {\n          for (var i = 0; i < data.results.length; i++) {\n            var loc = data.results[i];\n            var center = L.latLng(loc.geometry);\n            var bbox = void 0;\n\n            if (loc.annotations && loc.annotations.bounds) {\n              bbox = L.latLngBounds(L.latLng(loc.annotations.bounds.northeast), L.latLng(loc.annotations.bounds.southwest));\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n\n            results.push({\n              name: loc.formatted,\n              bbox: bbox,\n              center: center\n            });\n          }\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return OpenCage;\n  }();\n\n  function opencage(options) {\n    return new OpenCage(options);\n  }\n  /**\r\n   * Implementation of the [Pelias](https://pelias.io/), [geocode.earth](https://geocode.earth/) geocoder (formerly Mapzen Search)\r\n   */\n\n\n  var Pelias = /*#__PURE__*/function () {\n    function Pelias(options) {\n      this.options = {\n        serviceUrl: 'https://api.geocode.earth/v1'\n      };\n      this._lastSuggest = 0;\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = Pelias.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var _this = this;\n\n      var params = geocodingParams(this.options, {\n        api_key: this.options.apiKey,\n        text: query\n      });\n      getJSON(this.options.serviceUrl + '/search', params, function (data) {\n        cb.call(context, _this._parseResults(data, 'bbox'));\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      var _this2 = this;\n\n      var params = geocodingParams(this.options, {\n        api_key: this.options.apiKey,\n        text: query\n      });\n      getJSON(this.options.serviceUrl + '/autocomplete', params, function (data) {\n        if (data.geocoding.timestamp > _this2._lastSuggest) {\n          _this2._lastSuggest = data.geocoding.timestamp;\n          cb.call(context, _this2._parseResults(data, 'bbox'));\n        }\n      });\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      var _this3 = this;\n\n      var params = reverseParams(this.options, {\n        api_key: this.options.apiKey,\n        'point.lat': location.lat,\n        'point.lon': location.lng\n      });\n      getJSON(this.options.serviceUrl + '/reverse', params, function (data) {\n        cb.call(context, _this3._parseResults(data, 'bounds'));\n      });\n    };\n\n    _proto._parseResults = function _parseResults(data, bboxname) {\n      var results = [];\n      L.geoJSON(data, {\n        pointToLayer: function pointToLayer(feature, latlng) {\n          return L.circleMarker(latlng);\n        },\n        onEachFeature: function onEachFeature(feature, layer) {\n          var result = {};\n          var bbox;\n          var center;\n\n          if (layer.getBounds) {\n            bbox = layer.getBounds();\n            center = bbox.getCenter();\n          } else if (layer.feature.bbox) {\n            center = layer.getLatLng();\n            bbox = L.latLngBounds(L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(0, 2)), L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(2, 4)));\n          } else {\n            center = layer.getLatLng();\n            bbox = L.latLngBounds(center, center);\n          }\n\n          result.name = layer.feature.properties.label;\n          result.center = center;\n          result[bboxname] = bbox;\n          result.properties = layer.feature.properties;\n          results.push(result);\n        }\n      });\n      return results;\n    };\n\n    return Pelias;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Pelias}\r\n   * @param options the options\r\n   */\n\n\n  function pelias(options) {\n    return new Pelias(options);\n  }\n\n  var GeocodeEarth = Pelias;\n  var geocodeEarth = pelias;\n  /**\r\n   * r.i.p.\r\n   * @deprecated\r\n   */\n\n  var Mapzen = Pelias;\n  /**\r\n   * r.i.p.\r\n   * @deprecated\r\n   */\n\n  var mapzen = pelias;\n  /**\r\n   * Implementation of the [Openrouteservice](https://openrouteservice.org/dev/#/api-docs/geocode) geocoder\r\n   */\n\n  var Openrouteservice = /*#__PURE__*/function (_Pelias) {\n    _inheritsLoose(Openrouteservice, _Pelias);\n\n    function Openrouteservice(options) {\n      return _Pelias.call(this, L.Util.extend({\n        serviceUrl: 'https://api.openrouteservice.org/geocode'\n      }, options)) || this;\n    }\n\n    return Openrouteservice;\n  }(Pelias);\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Openrouteservice}\r\n   * @param options the options\r\n   */\n\n\n  function openrouteservice(options) {\n    return new Openrouteservice(options);\n  }\n  /**\r\n   * Implementation of the [Photon](http://photon.komoot.de/) geocoder\r\n   */\n\n\n  var Photon = /*#__PURE__*/function () {\n    function Photon(options) {\n      this.options = {\n        serviceUrl: 'https://photon.komoot.io/api/',\n        reverseUrl: 'https://photon.komoot.io/reverse/',\n        nameProperties: ['name', 'street', 'suburb', 'hamlet', 'town', 'city', 'state', 'country']\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = Photon.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      var params = geocodingParams(this.options, {\n        q: query\n      });\n      getJSON(this.options.serviceUrl, params, L.Util.bind(function (data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this));\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    };\n\n    _proto.reverse = function reverse(latLng, scale, cb, context) {\n      var params = reverseParams(this.options, {\n        lat: latLng.lat,\n        lon: latLng.lng\n      });\n      getJSON(this.options.reverseUrl, params, L.Util.bind(function (data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this));\n    };\n\n    _proto._decodeFeatures = function _decodeFeatures(data) {\n      var results = [];\n\n      if (data && data.features) {\n        for (var i = 0; i < data.features.length; i++) {\n          var f = data.features[i];\n          var c = f.geometry.coordinates;\n          var center = L.latLng(c[1], c[0]);\n          var extent = f.properties.extent;\n          var bbox = extent ? L.latLngBounds([extent[1], extent[0]], [extent[3], extent[2]]) : L.latLngBounds(center, center);\n          results.push({\n            name: this._decodeFeatureName(f),\n            html: this.options.htmlTemplate ? this.options.htmlTemplate(f) : undefined,\n            center: center,\n            bbox: bbox,\n            properties: f.properties\n          });\n        }\n      }\n\n      return results;\n    };\n\n    _proto._decodeFeatureName = function _decodeFeatureName(f) {\n      return (this.options.nameProperties || []).map(function (p) {\n        return f.properties[p];\n      }).filter(function (v) {\n        return !!v;\n      }).join(', ');\n    };\n\n    return Photon;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Photon}\r\n   * @param options the options\r\n   */\n\n\n  function photon(options) {\n    return new Photon(options);\n  }\n  /**\r\n   * Implementation of the What3Words service\r\n   */\n\n\n  var What3Words = /*#__PURE__*/function () {\n    function What3Words(options) {\n      this.options = {\n        serviceUrl: 'https://api.what3words.com/v2/'\n      };\n      L.Util.setOptions(this, options);\n    }\n\n    var _proto = What3Words.prototype;\n\n    _proto.geocode = function geocode(query, cb, context) {\n      //get three words and make a dot based string\n      getJSON(this.options.serviceUrl + 'forward', geocodingParams(this.options, {\n        key: this.options.apiKey,\n        addr: query.split(/\\s+/).join('.')\n      }), function (data) {\n        var results = [];\n\n        if (data.geometry) {\n          var latLng = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          var latLngBounds = L.latLngBounds(latLng, latLng);\n          results[0] = {\n            name: data.words,\n            bbox: latLngBounds,\n            center: latLng\n          };\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    _proto.suggest = function suggest(query, cb, context) {\n      return this.geocode(query, cb, context);\n    };\n\n    _proto.reverse = function reverse(location, scale, cb, context) {\n      getJSON(this.options.serviceUrl + 'reverse', reverseParams(this.options, {\n        key: this.options.apiKey,\n        coords: [location.lat, location.lng].join(',')\n      }), function (data) {\n        var results = [];\n\n        if (data.status.status == 200) {\n          var center = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          var bbox = L.latLngBounds(center, center);\n          results[0] = {\n            name: data.words,\n            bbox: bbox,\n            center: center\n          };\n        }\n\n        cb.call(context, results);\n      });\n    };\n\n    return What3Words;\n  }();\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link What3Words}\r\n   * @param options the options\r\n   */\n\n\n  function what3words(options) {\n    return new What3Words(options);\n  }\n\n  var geocoders = {\n    __proto__: null,\n    geocodingParams: geocodingParams,\n    reverseParams: reverseParams,\n    ArcGis: ArcGis,\n    arcgis: arcgis,\n    Bing: Bing,\n    bing: bing,\n    Google: Google,\n    google: google,\n    HERE: HERE,\n    HEREv2: HEREv2,\n    here: here,\n    parseLatLng: parseLatLng,\n    LatLng: LatLng,\n    latLng: latLng,\n    Mapbox: Mapbox,\n    mapbox: mapbox,\n    MapQuest: MapQuest,\n    mapQuest: mapQuest,\n    Neutrino: Neutrino,\n    neutrino: neutrino,\n    Nominatim: Nominatim,\n    nominatim: nominatim,\n    OpenLocationCode: OpenLocationCode,\n    openLocationCode: openLocationCode,\n    OpenCage: OpenCage,\n    opencage: opencage,\n    Pelias: Pelias,\n    pelias: pelias,\n    GeocodeEarth: GeocodeEarth,\n    geocodeEarth: geocodeEarth,\n    Mapzen: Mapzen,\n    mapzen: mapzen,\n    Openrouteservice: Openrouteservice,\n    openrouteservice: openrouteservice,\n    Photon: Photon,\n    photon: photon,\n    What3Words: What3Words,\n    what3words: what3words\n  };\n  /**\r\n   * Leaflet mixins https://leafletjs.com/reference-1.7.1.html#class-includes\r\n   * for TypeScript https://www.typescriptlang.org/docs/handbook/mixins.html\r\n   * @internal\r\n   */\n\n  var EventedControl = // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  function EventedControl() {// empty\n  };\n\n  L.Util.extend(EventedControl.prototype, L.Control.prototype);\n  L.Util.extend(EventedControl.prototype, L.Evented.prototype);\n  /**\r\n   * This is the geocoder control. It works like any other [Leaflet control](https://leafletjs.com/reference.html#control), and is added to the map.\r\n   */\n\n  var GeocoderControl = /*#__PURE__*/function (_EventedControl) {\n    _inheritsLoose(GeocoderControl, _EventedControl);\n    /**\r\n     * Instantiates a geocoder control (to be invoked using `new`)\r\n     * @param options the options\r\n     */\n\n\n    function GeocoderControl(options) {\n      var _this;\n\n      _this = _EventedControl.call(this, options) || this;\n      _this.options = {\n        showUniqueResult: true,\n        showResultIcons: false,\n        collapsed: true,\n        expand: 'touch',\n        position: 'topright',\n        placeholder: 'Search...',\n        errorMessage: 'Nothing found.',\n        iconLabel: 'Initiate a new search',\n        query: '',\n        queryMinLength: 1,\n        suggestMinLength: 3,\n        suggestTimeout: 250,\n        defaultMarkGeocode: true\n      };\n      _this._requestCount = 0;\n      L.Util.setOptions(_assertThisInitialized(_this), options);\n\n      if (!_this.options.geocoder) {\n        _this.options.geocoder = new Nominatim();\n      }\n\n      return _this;\n    }\n\n    var _proto = GeocoderControl.prototype;\n\n    _proto.addThrobberClass = function addThrobberClass() {\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-throbber');\n    };\n\n    _proto.removeThrobberClass = function removeThrobberClass() {\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-throbber');\n    }\n    /**\r\n     * Returns the container DOM element for the control and add listeners on relevant map events.\r\n     * @param map the map instance\r\n     * @see https://leafletjs.com/reference.html#control-onadd\r\n     */\n    ;\n\n    _proto.onAdd = function onAdd(map) {\n      var _this2 = this;\n\n      var className = 'leaflet-control-geocoder';\n      var container = L.DomUtil.create('div', className + ' leaflet-bar');\n      var icon = L.DomUtil.create('button', className + '-icon', container);\n      var form = this._form = L.DomUtil.create('div', className + '-form', container);\n      this._map = map;\n      this._container = container;\n      icon.innerHTML = '&nbsp;';\n      icon.type = 'button';\n      icon.setAttribute('aria-label', this.options.iconLabel);\n      var input = this._input = L.DomUtil.create('input', '', form);\n      input.type = 'text';\n      input.value = this.options.query;\n      input.placeholder = this.options.placeholder;\n      L.DomEvent.disableClickPropagation(input);\n      this._errorElement = L.DomUtil.create('div', className + '-form-no-error', container);\n      this._errorElement.innerHTML = this.options.errorMessage;\n      this._alts = L.DomUtil.create('ul', className + '-alternatives leaflet-control-geocoder-alternatives-minimized', container);\n      L.DomEvent.disableClickPropagation(this._alts);\n      L.DomEvent.addListener(input, 'keydown', this._keydown, this);\n\n      if (this.options.geocoder.suggest) {\n        L.DomEvent.addListener(input, 'input', this._change, this);\n      }\n\n      L.DomEvent.addListener(input, 'blur', function () {\n        if (_this2.options.collapsed && !_this2._preventBlurCollapse) {\n          _this2._collapse();\n        }\n\n        _this2._preventBlurCollapse = false;\n      });\n\n      if (this.options.collapsed) {\n        if (this.options.expand === 'click') {\n          L.DomEvent.addListener(container, 'click', function (e) {\n            if (e.button === 0 && e.detail !== 2) {\n              _this2._toggle();\n            }\n          });\n        } else if (this.options.expand === 'touch') {\n          L.DomEvent.addListener(container, L.Browser.touch ? 'touchstart mousedown' : 'mousedown', function (e) {\n            _this2._toggle();\n\n            e.preventDefault(); // mobile: clicking focuses the icon, so UI expands and immediately collapses\n\n            e.stopPropagation();\n          }, this);\n        } else {\n          L.DomEvent.addListener(container, 'mouseover', this._expand, this);\n          L.DomEvent.addListener(container, 'mouseout', this._collapse, this);\n\n          this._map.on('movestart', this._collapse, this);\n        }\n      } else {\n        this._expand();\n\n        if (L.Browser.touch) {\n          L.DomEvent.addListener(container, 'touchstart', function () {\n            return _this2._geocode();\n          });\n        } else {\n          L.DomEvent.addListener(container, 'click', function () {\n            return _this2._geocode();\n          });\n        }\n      }\n\n      if (this.options.defaultMarkGeocode) {\n        this.on('markgeocode', this.markGeocode, this);\n      }\n\n      this.on('startgeocode', this.addThrobberClass, this);\n      this.on('finishgeocode', this.removeThrobberClass, this);\n      this.on('startsuggest', this.addThrobberClass, this);\n      this.on('finishsuggest', this.removeThrobberClass, this);\n      L.DomEvent.disableClickPropagation(container);\n      return container;\n    }\n    /**\r\n     * Sets the query string on the text input\r\n     * @param string the query string\r\n     */\n    ;\n\n    _proto.setQuery = function setQuery(string) {\n      this._input.value = string;\n      return this;\n    };\n\n    _proto._geocodeResult = function _geocodeResult(results, suggest) {\n      if (!suggest && this.options.showUniqueResult && results.length === 1) {\n        this._geocodeResultSelected(results[0]);\n      } else if (results.length > 0) {\n        this._alts.innerHTML = '';\n        this._results = results;\n        L.DomUtil.removeClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n        L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-open');\n\n        for (var i = 0; i < results.length; i++) {\n          this._alts.appendChild(this._createAlt(results[i], i));\n        }\n      } else {\n        L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-error');\n        L.DomUtil.addClass(this._errorElement, 'leaflet-control-geocoder-error');\n      }\n    }\n    /**\r\n     * Marks a geocoding result on the map\r\n     * @param result the geocoding result\r\n     */\n    ;\n\n    _proto.markGeocode = function markGeocode(result) {\n      result = result.geocode || result;\n\n      this._map.fitBounds(result.bbox);\n\n      if (this._geocodeMarker) {\n        this._map.removeLayer(this._geocodeMarker);\n      }\n\n      this._geocodeMarker = new L.Marker(result.center).bindPopup(result.html || result.name).addTo(this._map).openPopup();\n      return this;\n    };\n\n    _proto._geocode = function _geocode(suggest) {\n      var _this3 = this;\n\n      var value = this._input.value;\n\n      if (!suggest && value.length < this.options.queryMinLength) {\n        return;\n      }\n\n      var requestCount = ++this._requestCount;\n\n      var cb = function cb(results) {\n        if (requestCount === _this3._requestCount) {\n          _this3.fire(suggest ? 'finishsuggest' : 'finishgeocode', {\n            input: value,\n            results: results\n          });\n\n          _this3._geocodeResult(results, suggest);\n        }\n      };\n\n      this._lastGeocode = value;\n\n      if (!suggest) {\n        this._clearResults();\n      }\n\n      this.fire(suggest ? 'startsuggest' : 'startgeocode', {\n        input: value\n      });\n\n      if (suggest) {\n        this.options.geocoder.suggest(value, cb);\n      } else {\n        this.options.geocoder.geocode(value, cb);\n      }\n    };\n\n    _proto._geocodeResultSelected = function _geocodeResultSelected(result) {\n      this.fire('markgeocode', {\n        geocode: result\n      });\n    };\n\n    _proto._toggle = function _toggle() {\n      if (L.DomUtil.hasClass(this._container, 'leaflet-control-geocoder-expanded')) {\n        this._collapse();\n      } else {\n        this._expand();\n      }\n    };\n\n    _proto._expand = function _expand() {\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-expanded');\n\n      this._input.select();\n\n      this.fire('expand');\n    };\n\n    _proto._collapse = function _collapse() {\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-expanded');\n      L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n      L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n\n      this._input.blur(); // mobile: keyboard shouldn't stay expanded\n\n\n      this.fire('collapse');\n    };\n\n    _proto._clearResults = function _clearResults() {\n      L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n      this._selection = null;\n      L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n      L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n    };\n\n    _proto._createAlt = function _createAlt(result, index) {\n      var _this4 = this;\n\n      var li = L.DomUtil.create('li', ''),\n          a = L.DomUtil.create('a', '', li),\n          icon = this.options.showResultIcons && result.icon ? L.DomUtil.create('img', '', a) : null,\n          text = result.html ? undefined : document.createTextNode(result.name),\n          mouseDownHandler = function mouseDownHandler(e) {\n        // In some browsers, a click will fire on the map if the control is\n        // collapsed directly after mousedown. To work around this, we\n        // wait until the click is completed, and _then_ collapse the\n        // control. Messy, but this is the workaround I could come up with\n        // for #142.\n        _this4._preventBlurCollapse = true;\n        L.DomEvent.stop(e);\n\n        _this4._geocodeResultSelected(result);\n\n        L.DomEvent.on(li, 'click touchend', function () {\n          if (_this4.options.collapsed) {\n            _this4._collapse();\n          } else {\n            _this4._clearResults();\n          }\n        });\n      };\n\n      if (icon) {\n        icon.src = result.icon;\n      }\n\n      li.setAttribute('data-result-index', String(index));\n\n      if (result.html) {\n        a.innerHTML = a.innerHTML + result.html;\n      } else if (text) {\n        a.appendChild(text);\n      } // Use mousedown and not click, since click will fire _after_ blur,\n      // causing the control to have collapsed and removed the items\n      // before the click can fire.\n\n\n      L.DomEvent.addListener(li, 'mousedown touchstart', mouseDownHandler, this);\n      return li;\n    };\n\n    _proto._keydown = function _keydown(e) {\n      var _this5 = this;\n\n      var select = function select(dir) {\n        if (_this5._selection) {\n          L.DomUtil.removeClass(_this5._selection, 'leaflet-control-geocoder-selected');\n          _this5._selection = _this5._selection[dir > 0 ? 'nextSibling' : 'previousSibling'];\n        }\n\n        if (!_this5._selection) {\n          _this5._selection = _this5._alts[dir > 0 ? 'firstChild' : 'lastChild'];\n        }\n\n        if (_this5._selection) {\n          L.DomUtil.addClass(_this5._selection, 'leaflet-control-geocoder-selected');\n        }\n      };\n\n      switch (e.keyCode) {\n        // Escape\n        case 27:\n          if (this.options.collapsed) {\n            this._collapse();\n          } else {\n            this._clearResults();\n          }\n\n          break;\n        // Up\n\n        case 38:\n          select(-1);\n          break;\n        // Up\n\n        case 40:\n          select(1);\n          break;\n        // Enter\n\n        case 13:\n          if (this._selection) {\n            var index = parseInt(this._selection.getAttribute('data-result-index'), 10);\n\n            this._geocodeResultSelected(this._results[index]);\n\n            this._clearResults();\n          } else {\n            this._geocode();\n          }\n\n          break;\n\n        default:\n          return;\n      }\n\n      L.DomEvent.preventDefault(e);\n    };\n\n    _proto._change = function _change() {\n      var _this6 = this;\n\n      var v = this._input.value;\n\n      if (v !== this._lastGeocode) {\n        clearTimeout(this._suggestTimeout);\n\n        if (v.length >= this.options.suggestMinLength) {\n          this._suggestTimeout = setTimeout(function () {\n            return _this6._geocode(true);\n          }, this.options.suggestTimeout);\n        } else {\n          this._clearResults();\n        }\n      }\n    };\n\n    return GeocoderControl;\n  }(EventedControl);\n  /**\r\n   * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link GeocoderControl}\r\n   * @param options the options\r\n   */\n\n\n  function geocoder(options) {\n    return new GeocoderControl(options);\n  }\n  /* @preserve\r\n   * Leaflet Control Geocoder\r\n   * https://github.com/perliedman/leaflet-control-geocoder\r\n   *\r\n   * Copyright (c) 2012 sa3m (https://github.com/sa3m)\r\n   * Copyright (c) 2018 Per Liedman\r\n   * All rights reserved.\r\n   */\n\n\n  L.Util.extend(GeocoderControl, geocoders);\n  L.Util.extend(L.Control, {\n    Geocoder: GeocoderControl,\n    geocoder: geocoder\n  });\n  return GeocoderControl;\n}(L);","map":{"version":3,"sources":["../src/geocoders/api.ts","../src/util.ts","../src/geocoders/arcgis.ts","../src/geocoders/bing.ts","../src/geocoders/google.ts","../src/geocoders/here.ts","../src/geocoders/latlng.ts","../src/geocoders/mapbox.ts","../src/geocoders/mapquest.ts","../src/geocoders/neutrino.ts","../src/geocoders/nominatim.ts","../src/geocoders/open-location-code.ts","../src/geocoders/opencage.ts","../src/geocoders/pelias.ts","../src/geocoders/photon.ts","../src/geocoders/what3words.ts","../src/control.ts","../src/index.ts"],"names":["geocodingParams","options","params","L","reverseParams","lastCallbackId","badChars","possible","escape","htmlEscape","string","jsonp","url","callback","context","jsonpParam","callbackId","window","script","document","getParamString","getJSON","xmlHttp","message","JSON","template","str","data","value","obj","existingUrl","uppercase","key","encodeURIComponent","i","Array","String","j","ArcGis","serviceUrl","apiKey","geocode","token","SingleLine","outFields","forStorage","maxLocations","f","results","loc","latLng","latLngBounds","name","bbox","center","cb","suggest","reverse","location","distance","result","arcgis","Bing","query","resource","bing","Google","address","properties","address_components","latlng","google","HERE","app_id","app_code","Error","searchtext","gen","jsonattributes","_proxRadius","proxRadius","prox","mode","HEREv2","q","at","item","here","parseLatLng","match","parseFloat","LatLng","next","sizeInMeters","Mapbox","_getProperties","text","id","access_token","param","mapbox","MapQuest","decodeURIComponent","_formatName","limit","outFormat","outputFormat","mapQuest","Neutrino","userId","latitude","longitude","lng","neutrino","Nominatim","htmlTemplate","r","parts","className","format","addressdetails","icon","html","lat","lon","zoom","Math","scale","nominatim","OpenLocationCode","decoded","console","code","openLocationCode","OpenCage","opencage","Pelias","api_key","_parseResults","pointToLayer","onEachFeature","layer","pelias","GeocodeEarth","geocodeEarth","Mapzen","mapzen","Openrouteservice","openrouteservice","Photon","reverseUrl","nameProperties","_decodeFeatures","c","extent","_decodeFeatureName","photon","What3Words","addr","coords","what3words","EventedControl","GeocoderControl","showUniqueResult","showResultIcons","collapsed","expand","position","placeholder","errorMessage","iconLabel","queryMinLength","suggestMinLength","suggestTimeout","defaultMarkGeocode","addThrobberClass","removeThrobberClass","onAdd","container","form","input","e","setQuery","_geocodeResult","markGeocode","_geocode","requestCount","_geocodeResultSelected","_toggle","_expand","_collapse","_clearResults","_createAlt","li","a","mouseDownHandler","_keydown","select","dir","index","parseInt","_change","v","clearTimeout","setTimeout","geocoder","Geocoder"],"mappings":"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","sourcesContent":["import * as L from 'leaflet';\n\n/**\n * An object that represents a result from a geocoding query\n */\nexport interface GeocodingResult {\n  /**\n   * Name of found location\n   */\n  name: string;\n  /**\n   * The bounds of the location\n   */\n  bbox: L.LatLngBounds;\n  /**\n   * The center coordinate of the location\n   */\n  center: L.LatLng;\n  /**\n   * URL for icon representing result; optional\n   */\n  icon?: string;\n  /**\n   * HTML formatted representation of the name\n   */\n  html?: string;\n  /**\n   * Additional properties returned by the geocoder\n   */\n  properties?: any;\n}\n\n/**\n * A callback function used in {@link IGeocoder.geocode} and {@link IGeocoder.suggest} and {@link IGeocoder.reverse}\n */\nexport type GeocodingCallback = (result: GeocodingResult[]) => void;\n\n/**\n * An interface implemented to respond to geocoding queries\n */\nexport interface IGeocoder {\n  /**\n   * Performs a geocoding query and returns the results to the callback in the provided context\n   * @param query the query\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  geocode(query: string, cb: GeocodingCallback, context?: any): void;\n  /**\n   * Performs a geocoding query suggestion (this happens while typing) and returns the results to the callback in the provided context\n   * @param query the query\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  suggest?(query: string, cb: GeocodingCallback, context?: any): void;\n  /**\n   * Performs a reverse geocoding query and returns the results to the callback in the provided context\n   * @param location the coordinate to reverse geocode\n   * @param scale the map scale possibly used for reverse geocoding\n   * @param cb the callback function\n   * @param context the `this` context in the callback\n   */\n  reverse?(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void;\n}\n\nexport interface GeocoderOptions {\n  /**\n   * URL of the service\n   */\n  serviceUrl: string;\n  /**\n   * Additional URL parameters (strings) that will be added to geocoding requests\n   */\n  geocodingQueryParams?: Record<string, unknown>;\n  /**\n   * Additional URL parameters (strings) that will be added to reverse geocoding requests\n   */\n  reverseQueryParams?: Record<string, unknown>;\n  /**\n   * API key to use this service\n   */\n  apiKey?: string;\n}\n\n/**\n * @internal\n */\nexport function geocodingParams(\n  options: GeocoderOptions,\n  params: Record<string, unknown>\n): Record<string, unknown> {\n  return L.Util.extend(params, options.geocodingQueryParams);\n}\n\n/**\n * @internal\n */\nexport function reverseParams(\n  options: GeocoderOptions,\n  params: Record<string, unknown>\n): Record<string, unknown> {\n  return L.Util.extend(params, options.reverseQueryParams);\n}\n","import * as L from 'leaflet';\n/**\n * @internal\n */\nlet lastCallbackId = 0;\n\n// Adapted from handlebars.js\n// https://github.com/wycats/handlebars.js/\n/**\n * @internal\n */\nconst badChars = /[&<>\"'`]/g;\n/**\n * @internal\n */\nconst possible = /[&<>\"'`]/;\n/**\n * @internal\n */\nconst escape: Record<string, string> = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '`': '&#x60;'\n};\n\n/**\n * @internal\n */\nfunction escapeChar(chr: string) {\n  return escape[chr];\n}\n\n/**\n * @internal\n */\nexport function htmlEscape(string?: string): string {\n  if (string == null) {\n    return '';\n  } else if (!string) {\n    return string + '';\n  }\n\n  // Force a string conversion as this will be done by the append regardless and\n  // the regex test will do this transparently behind the scenes, causing issues if\n  // an object's to string has escaped characters in it.\n  string = '' + string;\n\n  if (!possible.test(string)) {\n    return string;\n  }\n  return string.replace(badChars, escapeChar);\n}\n\n/**\n * @internal\n */\nexport function jsonp(\n  url: string,\n  params: Record<string, any>,\n  callback: (message: any) => void,\n  context: any,\n  jsonpParam?: string\n) {\n  const callbackId = '_l_geocoder_' + lastCallbackId++;\n  params[jsonpParam || 'callback'] = callbackId;\n  (window as any)[callbackId] = L.Util.bind(callback, context);\n  const script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.src = url + getParamString(params);\n  script.id = callbackId;\n  document.getElementsByTagName('head')[0].appendChild(script);\n}\n\n/**\n * @internal\n */\nexport function getJSON(\n  url: string,\n  params: Record<string, unknown>,\n  callback: (message: any) => void\n): void {\n  const xmlHttp = new XMLHttpRequest();\n  xmlHttp.onreadystatechange = function() {\n    if (xmlHttp.readyState !== 4) {\n      return;\n    }\n    let message;\n    if (xmlHttp.status !== 200 && xmlHttp.status !== 304) {\n      message = '';\n    } else if (typeof xmlHttp.response === 'string') {\n      // IE doesn't parse JSON responses even with responseType: 'json'.\n      try {\n        message = JSON.parse(xmlHttp.response);\n      } catch (e) {\n        // Not a JSON response\n        message = xmlHttp.response;\n      }\n    } else {\n      message = xmlHttp.response;\n    }\n    callback(message);\n  };\n  xmlHttp.open('GET', url + getParamString(params), true);\n  xmlHttp.responseType = 'json';\n  xmlHttp.setRequestHeader('Accept', 'application/json');\n  xmlHttp.send(null);\n}\n\n/**\n * @internal\n */\nexport function template(str: string, data: Record<string, any>): string {\n  return str.replace(/\\{ *([\\w_]+) *\\}/g, (str, key) => {\n    let value = data[key];\n    if (value === undefined) {\n      value = '';\n    } else if (typeof value === 'function') {\n      value = value(data);\n    }\n    return htmlEscape(value);\n  });\n}\n\n/**\n * @internal\n */\nexport function getParamString(\n  obj: Record<string, unknown | unknown[]>,\n  existingUrl?: string,\n  uppercase?: boolean\n): string {\n  const params = [];\n  for (const i in obj) {\n    const key = encodeURIComponent(uppercase ? i.toUpperCase() : i);\n    const value = obj[i];\n    if (!Array.isArray(value)) {\n      params.push(key + '=' + encodeURIComponent(String(value)));\n    } else {\n      for (let j = 0; j < value.length; j++) {\n        params.push(key + '=' + encodeURIComponent(value[j]));\n      }\n    }\n  }\n  return (!existingUrl || existingUrl.indexOf('?') === -1 ? '?' : '&') + params.join('&');\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface ArcGisOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [ArcGIS geocoder](https://developers.arcgis.com/features/geocoding/)\n */\nexport class ArcGis implements IGeocoder {\n  options: ArcGisOptions = {\n    serviceUrl: 'https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer',\n    apiKey: ''\n  };\n\n  constructor(options?: Partial<ArcGisOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      token: this.options.apiKey,\n      SingleLine: query,\n      outFields: 'Addr_Type',\n      forStorage: false,\n      maxLocations: 10,\n      f: 'json'\n    });\n\n    getJSON(this.options.serviceUrl + '/findAddressCandidates', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.candidates && data.candidates.length) {\n        for (let i = 0; i <= data.candidates.length - 1; i++) {\n          const loc = data.candidates[i];\n          const latLng = L.latLng(loc.location.y, loc.location.x);\n          const latLngBounds = L.latLngBounds(\n            L.latLng(loc.extent.ymax, loc.extent.xmax),\n            L.latLng(loc.extent.ymin, loc.extent.xmin)\n          );\n          results[i] = {\n            name: loc.address,\n            bbox: latLngBounds,\n            center: latLng\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      location: encodeURIComponent(location.lng) + ',' + encodeURIComponent(location.lat),\n      distance: 100,\n      f: 'json'\n    });\n    getJSON(this.options.serviceUrl + '/reverseGeocode', params, data => {\n      const result: GeocodingResult[] = [];\n      if (data && !data.error) {\n        const center = L.latLng(data.location.y, data.location.x);\n        const bbox = L.latLngBounds(center, center);\n        result.push({\n          name: data.address.Match_addr,\n          center: center,\n          bbox: bbox\n        });\n      }\n\n      cb.call(context, result);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link ArcGis}\n * @param options the options\n */\nexport function arcgis(options?: Partial<ArcGisOptions>) {\n  return new ArcGis(options);\n}\n","import * as L from 'leaflet';\nimport { jsonp } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface BingOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Bing Locations API](https://docs.microsoft.com/en-us/bingmaps/rest-services/locations/)\n */\nexport class Bing implements IGeocoder {\n  options: BingOptions = {\n    serviceUrl: 'https://dev.virtualearth.net/REST/v1/Locations'\n  };\n\n  constructor(options?: Partial<BingOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      query: query,\n      key: this.options.apiKey\n    });\n    jsonp(\n      this.options.apiKey,\n      params,\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.resourceSets.length > 0) {\n          for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n            const resource = data.resourceSets[0].resources[i],\n              bbox = resource.bbox;\n            results[i] = {\n              name: resource.name,\n              bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n              center: L.latLng(resource.point.coordinates)\n            };\n          }\n        }\n        cb.call(context, results);\n      },\n      this,\n      'jsonp'\n    );\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey\n    });\n    jsonp(\n      this.options.serviceUrl + location.lat + ',' + location.lng,\n      params,\n      data => {\n        const results: GeocodingResult[] = [];\n        for (let i = data.resourceSets[0].resources.length - 1; i >= 0; i--) {\n          const resource = data.resourceSets[0].resources[i],\n            bbox = resource.bbox;\n          results[i] = {\n            name: resource.name,\n            bbox: L.latLngBounds([bbox[0], bbox[1]], [bbox[2], bbox[3]]),\n            center: L.latLng(resource.point.coordinates)\n          };\n        }\n        cb.call(context, results);\n      },\n      this,\n      'jsonp'\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Bing}\n * @param options the options\n */\nexport function bing(options?: Partial<BingOptions>) {\n  return new Bing(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\n/**\n * Implementation of the [Google Geocoding API](https://developers.google.com/maps/documentation/geocoding/)\n */\nexport interface GoogleOptions extends GeocoderOptions {}\n\nexport class Google implements IGeocoder {\n  options: GoogleOptions = {\n    serviceUrl: 'https://maps.googleapis.com/maps/api/geocode/json'\n  };\n\n  constructor(options?: Partial<GoogleOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      address: query\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i <= data.results.length - 1; i++) {\n          const loc = data.results[i];\n          const latLng = L.latLng(loc.geometry.location);\n          const latLngBounds = L.latLngBounds(\n            L.latLng(loc.geometry.viewport.northeast),\n            L.latLng(loc.geometry.viewport.southwest)\n          );\n          results[i] = {\n            name: loc.formatted_address,\n            bbox: latLngBounds,\n            center: latLng,\n            properties: loc.address_components\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      latlng: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng)\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i <= data.results.length - 1; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry.location);\n          const bbox = L.latLngBounds(\n            L.latLng(loc.geometry.viewport.northeast),\n            L.latLng(loc.geometry.viewport.southwest)\n          );\n          results[i] = {\n            name: loc.formatted_address,\n            bbox: bbox,\n            center: center,\n            properties: loc.address_components\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Google}\n * @param options the options\n */\nexport function google(options?: Partial<GoogleOptions>) {\n  return new Google(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface HereOptions extends GeocoderOptions {\n  /**\n   * Use `apiKey` and the new `HEREv2` geocoder\n   * @deprecated\n   */\n  app_id: string;\n  /**\n   * Use `apiKey` and the new `HEREv2` geocoder\n   * @deprecated\n   */\n  app_code: string;\n  reverseGeocodeProxRadius?: any;\n  apiKey: string;\n}\n\n/**\n * Implementation of the [HERE Geocoder API](https://developer.here.com/documentation/geocoder/topics/introduction.html)\n */\nexport class HERE implements IGeocoder {\n  options: HereOptions = {\n    serviceUrl: 'https://geocoder.api.here.com/6.2/',\n    app_id: '',\n    app_code: '',\n    apiKey: ''\n  };\n\n  constructor(options?: Partial<HereOptions>) {\n    L.Util.setOptions(this, options);\n    if (options.apiKey) throw Error('apiKey is not supported, use app_id/app_code instead!');\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      searchtext: query,\n      gen: 9,\n      app_id: this.options.app_id,\n      app_code: this.options.app_code,\n      jsonattributes: 1\n    });\n    this.getJSON(this.options.serviceUrl + 'geocode.json', params, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const _proxRadius = this.options.reverseGeocodeProxRadius\n      ? this.options.reverseGeocodeProxRadius\n      : null;\n    const proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n    const params = reverseParams(this.options, {\n      prox: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng) + proxRadius,\n      mode: 'retrieveAddresses',\n      app_id: this.options.app_id,\n      app_code: this.options.app_code,\n      gen: 9,\n      jsonattributes: 1\n    });\n    this.getJSON(this.options.serviceUrl + 'reversegeocode.json', params, cb, context);\n  }\n\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\n    getJSON(url, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.response.view && data.response.view.length) {\n        for (let i = 0; i <= data.response.view[0].result.length - 1; i++) {\n          const loc = data.response.view[0].result[i].location;\n          const center = L.latLng(loc.displayPosition.latitude, loc.displayPosition.longitude);\n          const bbox = L.latLngBounds(\n            L.latLng(loc.mapView.topLeft.latitude, loc.mapView.topLeft.longitude),\n            L.latLng(loc.mapView.bottomRight.latitude, loc.mapView.bottomRight.longitude)\n          );\n          results[i] = {\n            name: loc.address.label,\n            properties: loc.address,\n            bbox: bbox,\n            center: center\n          };\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * Implementation of the new [HERE Geocoder API](https://developer.here.com/documentation/geocoding-search-api/api-reference-swagger.html)\n */\nexport class HEREv2 implements IGeocoder {\n  options: HereOptions = {\n    serviceUrl: 'https://geocode.search.hereapi.com/v1',\n    apiKey: '',\n    app_id: '',\n    app_code: ''\n  };\n\n  constructor(options?: Partial<HereOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      q: query,\n      apiKey: this.options.apiKey\n    });\n\n    if (!params.at && !params.in) {\n      throw Error(\n        'at / in parameters not found. Please define coordinates (at=latitude,longitude) or other (in) in your geocodingQueryParams.'\n      );\n    }\n\n    this.getJSON(this.options.serviceUrl + '/discover', params, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const _proxRadius = this.options.reverseGeocodeProxRadius\n      ? this.options.reverseGeocodeProxRadius\n      : null;\n    const proxRadius = _proxRadius ? ',' + encodeURIComponent(_proxRadius) : '';\n    const params = reverseParams(this.options, {\n      at: encodeURIComponent(location.lat) + ',' + encodeURIComponent(location.lng),\n      apiKey: this.options.apiKey\n    });\n\n    if (proxRadius) {\n      params.limit = proxRadius;\n    }\n\n    this.getJSON(this.options.serviceUrl + '/revgeocode', params, cb, context);\n  }\n\n  getJSON(url: string, params: any, cb: GeocodingCallback, context?: any) {\n    getJSON(url, params, data => {\n      const results: GeocodingResult[] = [];\n\n      if (data.items && data.items.length) {\n        for (let i = 0; i <= data.items.length - 1; i++) {\n          const item = data.items[i];\n          const latLng = L.latLng(item.position.lat, item.position.lng);\n          let bbox: L.LatLngBounds;\n          if (item.mapView) {\n            bbox = L.latLngBounds(\n              L.latLng(item.mapView.south, item.mapView.west),\n              L.latLng(item.mapView.north, item.mapView.east)\n            );\n          } else {\n            // Using only position when not provided\n            bbox = L.latLngBounds(\n              L.latLng(item.position.lat, item.position.lng),\n              L.latLng(item.position.lat, item.position.lng)\n            );\n          }\n          results[i] = {\n            name: item.address.label,\n            properties: item.address,\n            bbox: bbox,\n            center: latLng\n          };\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link HERE}\n * @param options the options\n */\nexport function here(options?: Partial<HereOptions>) {\n  if (options.apiKey) {\n    return new HEREv2(options);\n  } else {\n    return new HERE(options);\n  }\n}\n","import * as L from 'leaflet';\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\n\nexport interface LatLngOptions {\n  /**\n   * The next geocoder to use for non-supported queries\n   */\n  next?: IGeocoder;\n  /**\n   * The size in meters used for passing to `LatLng.toBounds`\n   */\n  sizeInMeters: number;\n}\n\n/**\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\n * @param query the latitude/longitude string to parse\n * @returns the parsed latitude/longitude\n */\nexport function parseLatLng(query: string): L.LatLng | undefined {\n  let match;\n  // regex from https://github.com/openstreetmap/openstreetmap-website/blob/master/app/controllers/geocoder_controller.rb\n  if ((match = query.match(/^([NS])\\s*(\\d{1,3}(?:\\.\\d*)?)\\W*([EW])\\s*(\\d{1,3}(?:\\.\\d*)?)$/))) {\n    // [NSEW] decimal degrees\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) * parseFloat(match[2]),\n      (/E/i.test(match[3]) ? 1 : -1) * parseFloat(match[4])\n    );\n  } else if (\n    (match = query.match(/^(\\d{1,3}(?:\\.\\d*)?)\\s*([NS])\\W*(\\d{1,3}(?:\\.\\d*)?)\\s*([EW])$/))\n  ) {\n    // decimal degrees [NSEW]\n    return L.latLng(\n      (/N/i.test(match[2]) ? 1 : -1) * parseFloat(match[1]),\n      (/E/i.test(match[4]) ? 1 : -1) * parseFloat(match[3])\n    );\n  } else if (\n    (match = query.match(\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?$/\n    ))\n  ) {\n    // [NSEW] degrees, decimal minutes\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) * (parseFloat(match[2]) + parseFloat(match[3]) / 60),\n      (/E/i.test(match[4]) ? 1 : -1) * (parseFloat(match[5]) + parseFloat(match[6]) / 60)\n    );\n  } else if (\n    (match = query.match(\n      /^(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,3}(?:\\.\\d*)?)?['′]?\\s*([EW])$/\n    ))\n  ) {\n    // degrees, decimal minutes [NSEW]\n    return L.latLng(\n      (/N/i.test(match[3]) ? 1 : -1) * (parseFloat(match[1]) + parseFloat(match[2]) / 60),\n      (/E/i.test(match[6]) ? 1 : -1) * (parseFloat(match[4]) + parseFloat(match[5]) / 60)\n    );\n  } else if (\n    (match = query.match(\n      /^([NS])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\W*([EW])\\s*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?$/\n    ))\n  ) {\n    // [NSEW] degrees, minutes, decimal seconds\n    return L.latLng(\n      (/N/i.test(match[1]) ? 1 : -1) *\n        (parseFloat(match[2]) + parseFloat(match[3]) / 60 + parseFloat(match[4]) / 3600),\n      (/E/i.test(match[5]) ? 1 : -1) *\n        (parseFloat(match[6]) + parseFloat(match[7]) / 60 + parseFloat(match[8]) / 3600)\n    );\n  } else if (\n    (match = query.match(\n      /^(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]\\s*([NS])\\W*(\\d{1,3})°?\\s*(\\d{1,2})['′]?\\s*(\\d{1,3}(?:\\.\\d*)?)?[\"″]?\\s*([EW])$/\n    ))\n  ) {\n    // degrees, minutes, decimal seconds [NSEW]\n    return L.latLng(\n      (/N/i.test(match[4]) ? 1 : -1) *\n        (parseFloat(match[1]) + parseFloat(match[2]) / 60 + parseFloat(match[3]) / 3600),\n      (/E/i.test(match[8]) ? 1 : -1) *\n        (parseFloat(match[5]) + parseFloat(match[6]) / 60 + parseFloat(match[7]) / 3600)\n    );\n  } else if ((match = query.match(/^\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*[\\s,]\\s*([+-]?\\d+(?:\\.\\d*)?)\\s*$/))) {\n    return L.latLng(parseFloat(match[1]), parseFloat(match[2]));\n  }\n}\n\n/**\n * Parses basic latitude/longitude strings such as `'50.06773 14.37742'`, `'N50.06773 W14.37742'`, `'S 50° 04.064 E 014° 22.645'`, or `'S 50° 4′ 03.828″, W 14° 22′ 38.712″'`\n */\nexport class LatLng implements IGeocoder {\n  options: LatLngOptions = {\n    next: undefined,\n    sizeInMeters: 10000\n  };\n\n  constructor(options?: Partial<LatLngOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    const center = parseLatLng(query);\n    if (center) {\n      const results: GeocodingResult[] = [\n        {\n          name: query,\n          center: center,\n          bbox: center.toBounds(this.options.sizeInMeters)\n        }\n      ];\n      cb.call(context, results);\n    } else if (this.options.next) {\n      this.options.next.geocode(query, cb, context);\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link LatLng}\n * @param options the options\n */\nexport function latLng(options?: Partial<LatLngOptions>) {\n  return new LatLng(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface MapboxOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Mapbox Geocoding](https://www.mapbox.com/api-documentation/#geocoding)\n */\nexport class Mapbox implements IGeocoder {\n  options: MapboxOptions = {\n    serviceUrl: 'https://api.mapbox.com/geocoding/v5/mapbox.places/'\n  };\n\n  constructor(options?: Partial<MapboxOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  _getProperties(loc) {\n    const properties = {\n      text: loc.text,\n      address: loc.address\n    };\n\n    for (let j = 0; j < (loc.context || []).length; j++) {\n      const id = loc.context[j].id.split('.')[0];\n      properties[id] = loc.context[j].text;\n\n      // Get country code when available\n      if (loc.context[j].short_code) {\n        properties['countryShortCode'] = loc.context[j].short_code;\n      }\n    }\n    return properties;\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params: any = geocodingParams(this.options, {\n      access_token: this.options.apiKey\n    });\n    if (\n      params.proximity !== undefined &&\n      params.proximity.lat !== undefined &&\n      params.proximity.lng !== undefined\n    ) {\n      params.proximity = params.proximity.lng + ',' + params.proximity.lat;\n    }\n    getJSON(this.options.serviceUrl + encodeURIComponent(query) + '.json', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.features && data.features.length) {\n        for (let i = 0; i <= data.features.length - 1; i++) {\n          const loc = data.features[i];\n          const center = L.latLng(loc.center.reverse());\n          let bbox: L.LatLngBounds;\n          if (loc.bbox) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.bbox.slice(0, 2).reverse()),\n              L.latLng(loc.bbox.slice(2, 4).reverse())\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n\n          results[i] = {\n            name: loc.place_name,\n            bbox: bbox,\n            center: center,\n            properties: this._getProperties(loc)\n          };\n        }\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const param = reverseParams(this.options, {\n      access_token: this.options.apiKey\n    });\n    getJSON(\n      this.options.serviceUrl +\n        encodeURIComponent(location.lng) +\n        ',' +\n        encodeURIComponent(location.lat) +\n        '.json',\n      param,\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.features && data.features.length) {\n          for (let i = 0; i <= data.features.length - 1; i++) {\n            const loc = data.features[i];\n            const center = L.latLng(loc.center.reverse());\n            let bbox: L.LatLngBounds;\n            if (loc.bbox) {\n              bbox = L.latLngBounds(\n                L.latLng(loc.bbox.slice(0, 2).reverse()),\n                L.latLng(loc.bbox.slice(2, 4).reverse())\n              );\n            } else {\n              bbox = L.latLngBounds(center, center);\n            }\n            results[i] = {\n              name: loc.place_name,\n              bbox: bbox,\n              center: center,\n              properties: this._getProperties(loc)\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Mapbox}\n * @param options the options\n */\nexport function mapbox(options?: Partial<MapboxOptions>) {\n  return new Mapbox(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface MapQuestOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [MapQuest Geocoding API](http://developer.mapquest.com/web/products/dev-services/geocoding-ws)\n */\nexport class MapQuest implements IGeocoder {\n  options: MapQuestOptions = {\n    serviceUrl: 'https://www.mapquestapi.com/geocoding/v1'\n  };\n\n  constructor(options?: Partial<MapQuestOptions>) {\n    L.Util.setOptions(this, options);\n    // MapQuest seems to provide URI encoded API keys,\n    // so to avoid encoding them twice, we decode them here\n    this.options.apiKey = decodeURIComponent(this.options.apiKey);\n  }\n\n  _formatName(...parts: string[]) {\n    return parts.filter(s => !!s).join(', ');\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      location: query,\n      limit: 5,\n      outFormat: 'json'\n    });\n    getJSON(\n      this.options.serviceUrl + '/address',\n      params,\n      L.Util.bind(function(data) {\n        const results: GeocodingResult[] = [];\n        if (data.results && data.results[0].locations) {\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\n            const loc = data.results[0].locations[i];\n            const center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this)\n    );\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      location: location.lat + ',' + location.lng,\n      outputFormat: 'json'\n    });\n    getJSON(\n      this.options.serviceUrl + '/reverse',\n      params,\n      L.Util.bind(function(data) {\n        const results: GeocodingResult[] = [];\n        if (data.results && data.results[0].locations) {\n          for (let i = data.results[0].locations.length - 1; i >= 0; i--) {\n            const loc = data.results[0].locations[i];\n            const center = L.latLng(loc.latLng);\n            results[i] = {\n              name: this._formatName(loc.street, loc.adminArea4, loc.adminArea3, loc.adminArea1),\n              bbox: L.latLngBounds(center, center),\n              center: center\n            };\n          }\n        }\n\n        cb.call(context, results);\n      }, this)\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link MapQuest}\n * @param options the options\n */\nexport function mapQuest(options?: Partial<MapQuestOptions>) {\n  return new MapQuest(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface NeutrinoOptions extends GeocoderOptions {\n  userId: string;\n}\n\n/**\n * Implementation of the [Neutrino API](https://www.neutrinoapi.com/api/geocode-address/)\n */\nexport class Neutrino implements IGeocoder {\n  options: NeutrinoOptions = {\n    userId: undefined,\n    apiKey: undefined,\n    serviceUrl: 'https://neutrinoapi.com/'\n  };\n\n  constructor(options?: Partial<NeutrinoOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  // https://www.neutrinoapi.com/api/geocode-address/\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      apiKey: this.options.apiKey,\n      userId: this.options.userId,\n      //get three words and make a dot based string\n      address: query.split(/\\s+/).join('.')\n    });\n    getJSON(this.options.serviceUrl + 'geocode-address', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.locations) {\n        data.geometry = data.locations[0];\n        const center = L.latLng(data.geometry['latitude'], data.geometry['longitude']);\n        const bbox = L.latLngBounds(center, center);\n        results[0] = {\n          name: data.geometry.address,\n          bbox: bbox,\n          center: center\n        };\n      }\n\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  // https://www.neutrinoapi.com/api/geocode-reverse/\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      apiKey: this.options.apiKey,\n      userId: this.options.userId,\n      latitude: location.lat,\n      longitude: location.lng\n    });\n    getJSON(this.options.serviceUrl + 'geocode-reverse', params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.status.status == 200 && data.found) {\n        const center = L.latLng(location.lat, location.lng);\n        const bbox = L.latLngBounds(center, center);\n        results[0] = {\n          name: data.address,\n          bbox: bbox,\n          center: center\n        };\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Neutrino}\n * @param options the options\n */\nexport function neutrino(options?: Partial<NeutrinoOptions>) {\n  return new Neutrino(options);\n}\n","import * as L from 'leaflet';\nimport { template, getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface NominatimResult {\n  place_id: number;\n  licence: string;\n  osm_type: string;\n  osm_id: number;\n  boundingbox: string[];\n  lat: string;\n  lon: string;\n  display_name: string;\n  class: string;\n  type: string;\n  importance: number;\n  icon?: string;\n  address: NominatimAddress;\n}\n\nexport interface NominatimAddress {\n  building?: string;\n  city_district?: string;\n  city?: string;\n  country_code?: string;\n  country?: string;\n  county?: string;\n  hamlet?: string;\n  house_number?: string;\n  neighbourhood?: string;\n  postcode?: string;\n  road?: string;\n  state_district?: string;\n  state?: string;\n  suburb?: string;\n  village?: string;\n}\n\nexport interface NominatimOptions extends GeocoderOptions {\n  /**\n   * Additional URL parameters (strings) that will be added to geocoding requests; can be used to restrict results to a specific country for example, by providing the [`countrycodes`](https://wiki.openstreetmap.org/wiki/Nominatim#Parameters) parameter to Nominatim\n   */\n  geocodingQueryParams?: Record<string, unknown>;\n  /**\n   * A function that takes an GeocodingResult as argument and returns an HTML formatted string that represents the result. Default function breaks up address in parts from most to least specific, in attempt to increase readability compared to Nominatim's naming\n   */\n  htmlTemplate: (r: NominatimResult) => string;\n}\n\n/**\n * Implementation of the [Nominatim](https://wiki.openstreetmap.org/wiki/Nominatim) geocoder.\n *\n * This is the default geocoding service used by the control, unless otherwise specified in the options.\n *\n * Unless using your own Nominatim installation, please refer to the [Nominatim usage policy](https://operations.osmfoundation.org/policies/nominatim/).\n */\nexport class Nominatim implements IGeocoder {\n  options: NominatimOptions = {\n    serviceUrl: 'https://nominatim.openstreetmap.org/',\n    htmlTemplate: function(r: NominatimResult) {\n      const address = r.address;\n      let className: string;\n      const parts = [];\n      if (address.road || address.building) {\n        parts.push('{building} {road} {house_number}');\n      }\n\n      if (address.city || (address as any).town || address.village || address.hamlet) {\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-detail' : '';\n        parts.push(\n          '<span class=\"' + className + '\">{postcode} {city} {town} {village} {hamlet}</span>'\n        );\n      }\n\n      if (address.state || address.country) {\n        className = parts.length > 0 ? 'leaflet-control-geocoder-address-context' : '';\n        parts.push('<span class=\"' + className + '\">{state} {country}</span>');\n      }\n\n      return template(parts.join('<br/>'), address);\n    }\n  };\n\n  constructor(options?: Partial<NominatimOptions>) {\n    L.Util.setOptions(this, options || {});\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    const params = geocodingParams(this.options, {\n      q: query,\n      limit: 5,\n      format: 'json',\n      addressdetails: 1\n    });\n    getJSON(this.options.serviceUrl + 'search', params, data => {\n      const results: GeocodingResult[] = [];\n      for (let i = data.length - 1; i >= 0; i--) {\n        const bbox = data[i].boundingbox;\n        for (let j = 0; j < 4; j++) bbox[j] = parseFloat(bbox[j]);\n        results[i] = {\n          icon: data[i].icon,\n          name: data[i].display_name,\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data[i]) : undefined,\n          bbox: L.latLngBounds([bbox[0], bbox[2]], [bbox[1], bbox[3]]),\n          center: L.latLng(data[i].lat, data[i].lon),\n          properties: data[i]\n        };\n      }\n      cb.call(context, results);\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\n    const params = reverseParams(this.options, {\n      lat: location.lat,\n      lon: location.lng,\n      zoom: Math.round(Math.log(scale / 256) / Math.log(2)),\n      addressdetails: 1,\n      format: 'json'\n    });\n    getJSON(this.options.serviceUrl + 'reverse', params, data => {\n      const result: GeocodingResult[] = [];\n      if (data && data.lat && data.lon) {\n        const center = L.latLng(data.lat, data.lon);\n        const bbox = L.latLngBounds(center, center);\n        result.push({\n          name: data.display_name,\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(data) : undefined,\n          center: center,\n          bbox: bbox,\n          properties: data\n        });\n      }\n      cb.call(context, result);\n    });\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Nominatim}\n * @param options the options\n */\nexport function nominatim(options?: Partial<NominatimOptions>) {\n  return new Nominatim(options);\n}\n","import * as L from 'leaflet';\nimport { IGeocoder, GeocodingCallback, GeocodingResult } from './api';\n\nexport interface OpenLocationCodeOptions {\n  OpenLocationCode: OpenLocationCodeApi;\n  codeLength?: number;\n}\n\nexport interface OpenLocationCodeApi {\n  encode(latitude: number, longitude: number, codeLength?: number): string;\n  decode(code: string): CodeArea;\n}\n\nexport interface CodeArea {\n  latitudeLo: number;\n  longitudeLo: number;\n  latitudeHi: number;\n  longitudeHi: number;\n  latitudeCenter: number;\n  longitudeCenter: number;\n  codeLength: number;\n}\n\n/**\n * Implementation of the [Plus codes](https://plus.codes/) (formerly OpenLocationCode) (requires [open-location-code](https://www.npmjs.com/package/open-location-code))\n */\nexport class OpenLocationCode implements IGeocoder {\n  options: OpenLocationCodeOptions;\n  constructor(options?: Partial<OpenLocationCodeOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any) {\n    try {\n      const decoded = this.options.OpenLocationCode.decode(query);\n      const result: GeocodingResult = {\n        name: query,\n        center: L.latLng(decoded.latitudeCenter, decoded.longitudeCenter),\n        bbox: L.latLngBounds(\n          L.latLng(decoded.latitudeLo, decoded.longitudeLo),\n          L.latLng(decoded.latitudeHi, decoded.longitudeHi)\n        )\n      };\n      cb.call(context, [result]);\n    } catch (e) {\n      console.warn(e); // eslint-disable-line no-console\n      cb.call(context, []);\n    }\n  }\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any) {\n    try {\n      const code = this.options.OpenLocationCode.encode(\n        location.lat,\n        location.lng,\n        this.options.codeLength\n      );\n      const result = {\n        name: code,\n        center: L.latLng(location.lat, location.lng),\n        bbox: L.latLngBounds(\n          L.latLng(location.lat, location.lng),\n          L.latLng(location.lat, location.lng)\n        )\n      };\n      cb.call(context, [result]);\n    } catch (e) {\n      console.warn(e); // eslint-disable-line no-console\n      cb.call(context, []);\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link OpenLocationCode}\n * @param options the options\n */\nexport function openLocationCode(options?: Partial<OpenLocationCodeOptions>) {\n  return new OpenLocationCode(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface OpenCageOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [OpenCage Data API](https://opencagedata.com/)\n */\nexport class OpenCage implements IGeocoder {\n  options: OpenCageOptions = {\n    serviceUrl: 'https://api.opencagedata.com/geocode/v1/json'\n  };\n\n  constructor(options?: Partial<OpenCageOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      key: this.options.apiKey,\n      q: query\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i < data.results.length; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry);\n          let bbox: L.LatLngBounds;\n          if (loc.annotations && loc.annotations.bounds) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.annotations.bounds.northeast),\n              L.latLng(loc.annotations.bounds.southwest)\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n          results.push({\n            name: loc.formatted,\n            bbox: bbox,\n            center: center\n          });\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      key: this.options.apiKey,\n      q: [location.lat, location.lng].join(',')\n    });\n    getJSON(this.options.serviceUrl, params, data => {\n      const results: GeocodingResult[] = [];\n      if (data.results && data.results.length) {\n        for (let i = 0; i < data.results.length; i++) {\n          const loc = data.results[i];\n          const center = L.latLng(loc.geometry);\n          let bbox: L.LatLngBounds;\n          if (loc.annotations && loc.annotations.bounds) {\n            bbox = L.latLngBounds(\n              L.latLng(loc.annotations.bounds.northeast),\n              L.latLng(loc.annotations.bounds.southwest)\n            );\n          } else {\n            bbox = L.latLngBounds(center, center);\n          }\n          results.push({\n            name: loc.formatted,\n            bbox: bbox,\n            center: center\n          });\n        }\n      }\n      cb.call(context, results);\n    });\n  }\n}\n\nexport function opencage(options?: Partial<OpenCageOptions>) {\n  return new OpenCage(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface PeliasOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the [Pelias](https://pelias.io/), [geocode.earth](https://geocode.earth/) geocoder (formerly Mapzen Search)\n */\nexport class Pelias implements IGeocoder {\n  options: PeliasOptions = {\n    serviceUrl: 'https://api.geocode.earth/v1'\n  };\n\n  private _lastSuggest = 0;\n\n  constructor(options?: Partial<PeliasOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      api_key: this.options.apiKey,\n      text: query\n    });\n    getJSON(this.options.serviceUrl + '/search', params, data => {\n      cb.call(context, this._parseResults(data, 'bbox'));\n    });\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, {\n      api_key: this.options.apiKey,\n      text: query\n    });\n    getJSON(this.options.serviceUrl + '/autocomplete', params, data => {\n      if (data.geocoding.timestamp > this._lastSuggest) {\n        this._lastSuggest = data.geocoding.timestamp;\n        cb.call(context, this._parseResults(data, 'bbox'));\n      }\n    });\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      api_key: this.options.apiKey,\n      'point.lat': location.lat,\n      'point.lon': location.lng\n    });\n    getJSON(this.options.serviceUrl + '/reverse', params, data => {\n      cb.call(context, this._parseResults(data, 'bounds'));\n    });\n  }\n\n  _parseResults(data, bboxname) {\n    const results: GeocodingResult[] = [];\n    L.geoJSON(data, {\n      pointToLayer: function(feature, latlng) {\n        return L.circleMarker(latlng);\n      },\n      onEachFeature: function(feature, layer: any) {\n        const result = {} as GeocodingResult;\n        let bbox;\n        let center;\n\n        if (layer.getBounds) {\n          bbox = layer.getBounds();\n          center = bbox.getCenter();\n        } else if (layer.feature.bbox) {\n          center = layer.getLatLng();\n          bbox = L.latLngBounds(\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(0, 2)),\n            L.GeoJSON.coordsToLatLng(layer.feature.bbox.slice(2, 4))\n          );\n        } else {\n          center = layer.getLatLng();\n          bbox = L.latLngBounds(center, center);\n        }\n\n        result.name = layer.feature.properties.label;\n        result.center = center;\n        result[bboxname] = bbox;\n        result.properties = layer.feature.properties;\n        results.push(result);\n      }\n    });\n    return results;\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Pelias}\n * @param options the options\n */\nexport function pelias(options?: Partial<PeliasOptions>) {\n  return new Pelias(options);\n}\n\nexport const GeocodeEarth = Pelias;\nexport const geocodeEarth = pelias;\n\n/**\n * r.i.p.\n * @deprecated\n */\nexport const Mapzen = Pelias;\n/**\n * r.i.p.\n * @deprecated\n */\nexport const mapzen = pelias;\n\n/**\n * Implementation of the [Openrouteservice](https://openrouteservice.org/dev/#/api-docs/geocode) geocoder\n */\nexport class Openrouteservice extends Pelias {\n  constructor(options?: Partial<PeliasOptions>) {\n    super(\n      L.Util.extend(\n        {\n          serviceUrl: 'https://api.openrouteservice.org/geocode'\n        },\n        options\n      )\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Openrouteservice}\n * @param options the options\n */\nexport function openrouteservice(options?: Partial<PeliasOptions>) {\n  return new Openrouteservice(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface PhotonOptions extends GeocoderOptions {\n  reverseUrl: string;\n  nameProperties: string[];\n  htmlTemplate?: (r: any) => string;\n}\n\n/**\n * Implementation of the [Photon](http://photon.komoot.de/) geocoder\n */\nexport class Photon implements IGeocoder {\n  options: PhotonOptions = {\n    serviceUrl: 'https://photon.komoot.io/api/',\n    reverseUrl: 'https://photon.komoot.io/reverse/',\n    nameProperties: ['name', 'street', 'suburb', 'hamlet', 'town', 'city', 'state', 'country']\n  };\n\n  constructor(options?: Partial<PhotonOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    const params = geocodingParams(this.options, { q: query });\n    getJSON(\n      this.options.serviceUrl,\n      params,\n      L.Util.bind(function(data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this)\n    );\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(latLng: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    const params = reverseParams(this.options, {\n      lat: latLng.lat,\n      lon: latLng.lng\n    });\n    getJSON(\n      this.options.reverseUrl,\n      params,\n      L.Util.bind(function(data) {\n        cb.call(context, this._decodeFeatures(data));\n      }, this)\n    );\n  }\n\n  _decodeFeatures(data: GeoJSON.FeatureCollection<GeoJSON.Point>) {\n    const results: GeocodingResult[] = [];\n\n    if (data && data.features) {\n      for (let i = 0; i < data.features.length; i++) {\n        const f = data.features[i];\n        const c = f.geometry.coordinates;\n        const center = L.latLng(c[1], c[0]);\n        const extent = f.properties.extent;\n\n        const bbox = extent\n          ? L.latLngBounds([extent[1], extent[0]], [extent[3], extent[2]])\n          : L.latLngBounds(center, center);\n\n        results.push({\n          name: this._decodeFeatureName(f),\n          html: this.options.htmlTemplate ? this.options.htmlTemplate(f) : undefined,\n          center: center,\n          bbox: bbox,\n          properties: f.properties\n        });\n      }\n    }\n\n    return results;\n  }\n\n  _decodeFeatureName(f: GeoJSON.Feature) {\n    return (this.options.nameProperties || [])\n      .map(p => {\n        return f.properties[p];\n      })\n      .filter(v => {\n        return !!v;\n      })\n      .join(', ');\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link Photon}\n * @param options the options\n */\nexport function photon(options?: Partial<PhotonOptions>) {\n  return new Photon(options);\n}\n","import * as L from 'leaflet';\nimport { getJSON } from '../util';\nimport {\n  IGeocoder,\n  GeocoderOptions,\n  GeocodingCallback,\n  geocodingParams,\n  GeocodingResult,\n  reverseParams\n} from './api';\n\nexport interface What3WordsOptions extends GeocoderOptions {}\n\n/**\n * Implementation of the What3Words service\n */\nexport class What3Words implements IGeocoder {\n  options: What3WordsOptions = {\n    serviceUrl: 'https://api.what3words.com/v2/'\n  };\n\n  constructor(options: Partial<What3WordsOptions>) {\n    L.Util.setOptions(this, options);\n  }\n\n  geocode(query: string, cb: GeocodingCallback, context?: any): void {\n    //get three words and make a dot based string\n    getJSON(\n      this.options.serviceUrl + 'forward',\n      geocodingParams(this.options, {\n        key: this.options.apiKey,\n        addr: query.split(/\\s+/).join('.')\n      }),\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.geometry) {\n          const latLng = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          const latLngBounds = L.latLngBounds(latLng, latLng);\n          results[0] = {\n            name: data.words,\n            bbox: latLngBounds,\n            center: latLng\n          };\n        }\n\n        cb.call(context, results);\n      }\n    );\n  }\n\n  suggest(query: string, cb: GeocodingCallback, context?: any): void {\n    return this.geocode(query, cb, context);\n  }\n\n  reverse(location: L.LatLngLiteral, scale: number, cb: GeocodingCallback, context?: any): void {\n    getJSON(\n      this.options.serviceUrl + 'reverse',\n      reverseParams(this.options, {\n        key: this.options.apiKey,\n        coords: [location.lat, location.lng].join(',')\n      }),\n      data => {\n        const results: GeocodingResult[] = [];\n        if (data.status.status == 200) {\n          const center = L.latLng(data.geometry['lat'], data.geometry['lng']);\n          const bbox = L.latLngBounds(center, center);\n          results[0] = {\n            name: data.words,\n            bbox: bbox,\n            center: center\n          };\n        }\n        cb.call(context, results);\n      }\n    );\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link What3Words}\n * @param options the options\n */\nexport function what3words(options: Partial<What3WordsOptions>) {\n  return new What3Words(options);\n}\n","import * as L from 'leaflet';\nimport { Nominatim } from './geocoders/index';\nimport { IGeocoder, GeocodingResult } from './geocoders/api';\n\nexport interface GeocoderControlOptions extends L.ControlOptions {\n  /**\n   * Collapse control unless hovered/clicked\n   */\n  collapsed: boolean;\n  /**\n   * How to expand a collapsed control: `touch` or `click` or `hover`\n   */\n  expand: 'touch' | 'click' | 'hover';\n  /**\n   * Placeholder text for text input\n   */\n  placeholder: string;\n  /**\n   * Message when no result found / geocoding error occurs\n   */\n  errorMessage: string;\n  /**\n   * Accessibility label for the search icon used by screen readers\n   */\n  iconLabel: string;\n  /**\n   * Object to perform the actual geocoding queries\n   */\n  geocoder?: IGeocoder;\n  /**\n   * Immediately show the unique result without prompting for alternatives\n   */\n  showUniqueResult: boolean;\n  /**\n   * Show icons for geocoding results (if available); supported by Nominatim\n   */\n  showResultIcons: boolean;\n  /**\n   * Minimum number characters before suggest functionality is used (if available from geocoder)\n   */\n  suggestMinLength: number;\n  /**\n   * Number of milliseconds after typing stopped before suggest functionality is used (if available from geocoder)\n   */\n  suggestTimeout: number;\n  /**\n   * Initial query string for text input\n   */\n  query: string;\n  /**\n   * Minimum number of characters in search text before performing a query\n   */\n  queryMinLength: number;\n  /**\n   * Whether to mark a geocoding result on the map by default\n   */\n  defaultMarkGeocode: boolean;\n}\n\n\n/**\n * Leaflet mixins https://leafletjs.com/reference-1.7.1.html#class-includes\n * for TypeScript https://www.typescriptlang.org/docs/handbook/mixins.html\n * @internal\n */\nclass EventedControl {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  constructor(...args: any[]) {\n    // empty\n  }\n}\n\n/**\n * @internal\n */\ninterface EventedControl extends L.Control, L.Evented {}\nL.Util.extend(EventedControl.prototype, L.Control.prototype);\nL.Util.extend(EventedControl.prototype, L.Evented.prototype);\n\n/**\n * This is the geocoder control. It works like any other [Leaflet control](https://leafletjs.com/reference.html#control), and is added to the map.\n */\nexport class GeocoderControl extends EventedControl {\n  options: GeocoderControlOptions = {\n    showUniqueResult: true,\n    showResultIcons: false,\n    collapsed: true,\n    expand: 'touch',\n    position: 'topright',\n    placeholder: 'Search...',\n    errorMessage: 'Nothing found.',\n    iconLabel: 'Initiate a new search',\n    query: '',\n    queryMinLength: 1,\n    suggestMinLength: 3,\n    suggestTimeout: 250,\n    defaultMarkGeocode: true\n  };\n\n  private _alts: HTMLUListElement;\n  private _container: HTMLDivElement;\n  private _errorElement: HTMLDivElement;\n  private _form: HTMLDivElement;\n  private _geocodeMarker: L.Marker;\n  private _input: HTMLInputElement;\n  private _lastGeocode: string;\n  private _map: L.Map;\n  private _preventBlurCollapse: boolean;\n  private _requestCount = 0;\n  private _results: any;\n  private _selection: any;\n  private _suggestTimeout: any;\n\n  /**\n   * Instantiates a geocoder control (to be invoked using `new`)\n   * @param options the options\n   */\n  constructor(options?: Partial<GeocoderControlOptions>) {\n    super(options);\n    L.Util.setOptions(this, options);\n    if (!this.options.geocoder) {\n      this.options.geocoder = new Nominatim();\n    }\n  }\n\n  addThrobberClass() {\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-throbber');\n  }\n\n  removeThrobberClass() {\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-throbber');\n  }\n\n  /**\n   * Returns the container DOM element for the control and add listeners on relevant map events.\n   * @param map the map instance\n   * @see https://leafletjs.com/reference.html#control-onadd\n   */\n  onAdd(map: L.Map) {\n    const className = 'leaflet-control-geocoder';\n    const container = L.DomUtil.create('div', className + ' leaflet-bar') as HTMLDivElement;\n    const icon = L.DomUtil.create('button', className + '-icon', container) as HTMLButtonElement;\n    const form = (this._form = L.DomUtil.create(\n      'div',\n      className + '-form',\n      container\n    ) as HTMLDivElement);\n\n    this._map = map;\n    this._container = container;\n\n    icon.innerHTML = '&nbsp;';\n    icon.type = 'button';\n    icon.setAttribute('aria-label', this.options.iconLabel);\n\n    const input = (this._input = L.DomUtil.create('input', '', form) as HTMLInputElement);\n    input.type = 'text';\n    input.value = this.options.query;\n    input.placeholder = this.options.placeholder;\n    L.DomEvent.disableClickPropagation(input);\n\n    this._errorElement = L.DomUtil.create(\n      'div',\n      className + '-form-no-error',\n      container\n    ) as HTMLDivElement;\n    this._errorElement.innerHTML = this.options.errorMessage;\n\n    this._alts = L.DomUtil.create(\n      'ul',\n      className + '-alternatives leaflet-control-geocoder-alternatives-minimized',\n      container\n    ) as HTMLUListElement;\n    L.DomEvent.disableClickPropagation(this._alts);\n\n    L.DomEvent.addListener(input, 'keydown', this._keydown, this);\n    if (this.options.geocoder.suggest) {\n      L.DomEvent.addListener(input, 'input', this._change, this);\n    }\n    L.DomEvent.addListener(input, 'blur', () => {\n      if (this.options.collapsed && !this._preventBlurCollapse) {\n        this._collapse();\n      }\n      this._preventBlurCollapse = false;\n    });\n\n    if (this.options.collapsed) {\n      if (this.options.expand === 'click') {\n        L.DomEvent.addListener(container, 'click', (e: Event) => {\n          if ((e as MouseEvent).button === 0 && (e as MouseEvent).detail !== 2) {\n            this._toggle();\n          }\n        });\n      } else if (this.options.expand === 'touch') {\n        L.DomEvent.addListener(\n          container,\n          L.Browser.touch ? 'touchstart mousedown' : 'mousedown',\n          (e: Event) => {\n            this._toggle();\n            e.preventDefault(); // mobile: clicking focuses the icon, so UI expands and immediately collapses\n            e.stopPropagation();\n          },\n          this\n        );\n      } else {\n        L.DomEvent.addListener(container, 'mouseover', this._expand, this);\n        L.DomEvent.addListener(container, 'mouseout', this._collapse, this);\n        this._map.on('movestart', this._collapse, this);\n      }\n    } else {\n      this._expand();\n      if (L.Browser.touch) {\n        L.DomEvent.addListener(container, 'touchstart', () => this._geocode());\n      } else {\n        L.DomEvent.addListener(container, 'click', () => this._geocode());\n      }\n    }\n\n    if (this.options.defaultMarkGeocode) {\n      this.on('markgeocode', this.markGeocode as any, this);\n    }\n\n    this.on('startgeocode', this.addThrobberClass, this);\n    this.on('finishgeocode', this.removeThrobberClass, this);\n    this.on('startsuggest', this.addThrobberClass, this);\n    this.on('finishsuggest', this.removeThrobberClass, this);\n\n    L.DomEvent.disableClickPropagation(container);\n\n    return container;\n  }\n\n  /**\n   * Sets the query string on the text input\n   * @param string the query string\n   */\n  setQuery(string: string): this {\n    this._input.value = string;\n    return this;\n  }\n\n  private _geocodeResult(results: GeocodingResult[], suggest: boolean) {\n    if (!suggest && this.options.showUniqueResult && results.length === 1) {\n      this._geocodeResultSelected(results[0]);\n    } else if (results.length > 0) {\n      this._alts.innerHTML = '';\n      this._results = results;\n      L.DomUtil.removeClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-open');\n      for (let i = 0; i < results.length; i++) {\n        this._alts.appendChild(this._createAlt(results[i], i));\n      }\n    } else {\n      L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-options-error');\n      L.DomUtil.addClass(this._errorElement, 'leaflet-control-geocoder-error');\n    }\n  }\n\n  /**\n   * Marks a geocoding result on the map\n   * @param result the geocoding result\n   */\n  markGeocode(result: GeocodingResult) {\n    result = (result as any).geocode || result;\n\n    this._map.fitBounds(result.bbox);\n\n    if (this._geocodeMarker) {\n      this._map.removeLayer(this._geocodeMarker);\n    }\n\n    this._geocodeMarker = new L.Marker(result.center)\n      .bindPopup(result.html || result.name)\n      .addTo(this._map)\n      .openPopup();\n\n    return this;\n  }\n\n  private _geocode(suggest?: boolean) {\n    const value = this._input.value;\n    if (!suggest && value.length < this.options.queryMinLength) {\n      return;\n    }\n\n    const requestCount = ++this._requestCount;\n    const cb = (results: GeocodingResult[]) => {\n      if (requestCount === this._requestCount) {\n        this.fire(suggest ? 'finishsuggest' : 'finishgeocode', { input: value, results });\n        this._geocodeResult(results, suggest);\n      }\n    };\n\n    this._lastGeocode = value;\n    if (!suggest) {\n      this._clearResults();\n    }\n\n    this.fire(suggest ? 'startsuggest' : 'startgeocode', { input: value });\n    if (suggest) {\n      this.options.geocoder.suggest(value, cb);\n    } else {\n      this.options.geocoder.geocode(value, cb);\n    }\n  }\n\n  private _geocodeResultSelected(result: GeocodingResult) {\n    this.fire('markgeocode', { geocode: result });\n  }\n\n  private _toggle() {\n    if (L.DomUtil.hasClass(this._container, 'leaflet-control-geocoder-expanded')) {\n      this._collapse();\n    } else {\n      this._expand();\n    }\n  }\n\n  private _expand() {\n    L.DomUtil.addClass(this._container, 'leaflet-control-geocoder-expanded');\n    this._input.select();\n    this.fire('expand');\n  }\n\n  private _collapse() {\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-expanded');\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n    this._input.blur(); // mobile: keyboard shouldn't stay expanded\n    this.fire('collapse');\n  }\n\n  private _clearResults() {\n    L.DomUtil.addClass(this._alts, 'leaflet-control-geocoder-alternatives-minimized');\n    this._selection = null;\n    L.DomUtil.removeClass(this._errorElement, 'leaflet-control-geocoder-error');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-open');\n    L.DomUtil.removeClass(this._container, 'leaflet-control-geocoder-options-error');\n  }\n\n  private _createAlt(result: GeocodingResult, index: number) {\n    const li = L.DomUtil.create('li', ''),\n      a = L.DomUtil.create('a', '', li),\n      icon =\n        this.options.showResultIcons && result.icon\n          ? (L.DomUtil.create('img', '', a) as HTMLImageElement)\n          : null,\n      text = result.html ? undefined : document.createTextNode(result.name),\n      mouseDownHandler = (e: Event) => {\n        // In some browsers, a click will fire on the map if the control is\n        // collapsed directly after mousedown. To work around this, we\n        // wait until the click is completed, and _then_ collapse the\n        // control. Messy, but this is the workaround I could come up with\n        // for #142.\n        this._preventBlurCollapse = true;\n        L.DomEvent.stop(e);\n        this._geocodeResultSelected(result);\n        L.DomEvent.on(li, 'click touchend', () => {\n          if (this.options.collapsed) {\n            this._collapse();\n          } else {\n            this._clearResults();\n          }\n        });\n      };\n\n    if (icon) {\n      icon.src = result.icon;\n    }\n\n    li.setAttribute('data-result-index', String(index));\n\n    if (result.html) {\n      a.innerHTML = a.innerHTML + result.html;\n    } else if (text) {\n      a.appendChild(text);\n    }\n\n    // Use mousedown and not click, since click will fire _after_ blur,\n    // causing the control to have collapsed and removed the items\n    // before the click can fire.\n    L.DomEvent.addListener(li, 'mousedown touchstart', mouseDownHandler, this);\n\n    return li;\n  }\n\n  private _keydown(e: KeyboardEvent) {\n    const select = (dir: number) => {\n      if (this._selection) {\n        L.DomUtil.removeClass(this._selection, 'leaflet-control-geocoder-selected');\n        this._selection = this._selection[dir > 0 ? 'nextSibling' : 'previousSibling'];\n      }\n      if (!this._selection) {\n        this._selection = this._alts[dir > 0 ? 'firstChild' : 'lastChild'];\n      }\n\n      if (this._selection) {\n        L.DomUtil.addClass(this._selection, 'leaflet-control-geocoder-selected');\n      }\n    };\n\n    switch (e.keyCode) {\n      // Escape\n      case 27:\n        if (this.options.collapsed) {\n          this._collapse();\n        } else {\n          this._clearResults();\n        }\n        break;\n      // Up\n      case 38:\n        select(-1);\n        break;\n      // Up\n      case 40:\n        select(1);\n        break;\n      // Enter\n      case 13:\n        if (this._selection) {\n          const index = parseInt(this._selection.getAttribute('data-result-index'), 10);\n          this._geocodeResultSelected(this._results[index]);\n          this._clearResults();\n        } else {\n          this._geocode();\n        }\n        break;\n      default:\n        return;\n    }\n\n    L.DomEvent.preventDefault(e);\n  }\n\n  private _change() {\n    const v = this._input.value;\n    if (v !== this._lastGeocode) {\n      clearTimeout(this._suggestTimeout);\n      if (v.length >= this.options.suggestMinLength) {\n        this._suggestTimeout = setTimeout(() => this._geocode(true), this.options.suggestTimeout);\n      } else {\n        this._clearResults();\n      }\n    }\n  }\n}\n\n/**\n * [Class factory method](https://leafletjs.com/reference.html#class-class-factories) for {@link GeocoderControl}\n * @param options the options\n */\nexport function geocoder(options?: Partial<GeocoderControlOptions>) {\n  return new GeocoderControl(options);\n}\n","/* @preserve\n * Leaflet Control Geocoder\n * https://github.com/perliedman/leaflet-control-geocoder\n *\n * Copyright (c) 2012 sa3m (https://github.com/sa3m)\n * Copyright (c) 2018 Per Liedman\n * All rights reserved.\n */\nimport * as L from 'leaflet';\nimport { GeocoderControl as Geocoder, geocoder } from './control';\nimport * as geocoders from './geocoders/index';\n\nL.Util.extend(Geocoder, geocoders);\nexport default Geocoder;\n\nL.Util.extend(L.Control, {\n  Geocoder: Geocoder,\n  geocoder: geocoder\n});\n"]},"metadata":{},"sourceType":"script"}